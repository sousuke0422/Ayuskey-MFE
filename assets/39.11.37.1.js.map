{"version":3,"sources":["webpack:///./src/client/app/common/views/pages/room/room.vue?d5a3","webpack:///./src/client/app/common/scripts/room/furnitures.json5","webpack:///./src/client/app/common/views/pages/room/room.vue?6564","webpack:///./src/client/app/common/views/pages/room/room.vue?1bbb","webpack:///./src/client/app/common/views/pages/room/room.vue?6b22","webpack:///./src/client/app/common/scripts/room/room.ts","webpack:///./src/client/app/common/views/pages/room/preview.vue?d1ed","webpack:///./src/client/app/common/views/pages/room/preview.vue?c2fd","webpack:///./src/client/app/common/views/pages/room/preview.vue","webpack:///./src/client/app/common/views/pages/room/preview.vue?2b61","webpack:///./src/client/app/common/views/pages/room/room.vue?f897","webpack:///./src/client/app/common/views/pages/room/room.vue?c989","webpack:///./src/client/app/common/views/pages/room/room.vue"],"names":["content","module","i","locals","exports","add","default","id","place","props","color","Table","Board","Chair","color1","color2","Cushion","Leg","Cover","Pad","screen","texture","Screen","prop","uv","x","y","width","height","CarpetAreaA","CarpetAreaB","Mat","main","Cube","photo","Photo","Frame","body","belly","Body","Belly","picture","Poster","Sofa","Step","Bin","image","Image_Front","Image_Back","___CSS_LOADER_API_IMPORT___","push","__decorate","decorators","target","key","desc","d","c","arguments","length","r","Object","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","furnitureDefs","crossOrigin","user","isMyRoom","roomInfo","container","options","this","mixers","objects","selectedObject","isTransformMode","graphicsQuality","onChangeSelect","clock","scene","window","innerWidth","innerHeight","renderer","antialias","stencil","alpha","powerPreference","setPixelRatio","devicePixelRatio","setSize","autoClear","setClearColor","shadowMap","enabled","enableShadow","type","appendChild","canvas","camera","useOrthographicCamera","position","z","zoom","updateProjectionMatrix","ambientLight","roomLight","set","castShadow","shadow","bias","mapSize","shadowQuality","near","far","fov","outLight1","outLight2","controls","OrbitControls","enableZoom","enablePan","minPolarAngle","maxPolarAngle","Math","PI","minAzimuthAngle","maxAzimuthAngle","enableDamping","dampingFactor","mouseButtons","LEFT","MIDDLE","RIGHT","usePostFXs","renderTarget","minFilter","magFilter","format","stencilBuffer","fxaa","ShaderPass","FXAAShader","uniforms","value","renderToScreen","composer","EffectComposer","addPass","RenderPass","BloomPass","avatarUrl","url","textureLoader","iconTexture","load","wrapS","wrapT","anisotropy","avatarMaterial","map","side","alphaTest","iconGeometry","avatarObject","rotation","name","username","font","nameGeometry","size","curveSegments","bevelThickness","bevelSize","bevelEnabled","nameMaterial","nameObject","furnitureControl","TransformControls","onmousemove","onmousedown","loadRoom","furniture","furnitures","loadFurniture","then","obj","renderWithPostFXs","renderWithoutPostFXs","domElement","renderFrameRequestId","requestAnimationFrame","getDelta","mixer","update","render","clear","roomType","GLTFLoader","gltf","traverse","child","receiveShadow","material","roomObj","applyCarpetColor","def","find","Promise","res","rej","model","animations","clip","clipAction","play","metalness","applyCustomColor","applyCustomTexture","colorHex","parseInt","carpetColor","substr","setHex","t","keys","val","undefined","document","createElement","emissive","img","Image","onload","uvInfo","getContext","drawImage","flipY","needsUpdate","src","ev","rect","getBoundingClientRect","clientX","left","clientY","top","pos","updateMatrixWorld","raycaster","setFromCamera","intersects","intersectObjects","object","isSelectedObject","intersected","getRoot","button","selectedObj","selectFurniture","found","parent","setMode","attach","detach","uuid","exitTransformMode","remove","filter","f","cancelAnimationFrame","dispose","prototype","extend","data","selected","objectHeight","orbitRadius","$el","cullFace","light","grid","timer","Date","now","sin","cos","lookAt","clone","current","getObjectByName","objectBoundingBox","setFromObject","max","min","objectWidth","objectDepth","horizontal","hypot","aspect","tan","_h","$createElement","_self","_c","attrs","storeItems","room","i18n","components","XPreview","acct","String","required","objectSelected","selectedFurnitureName","selectedFurnitureInfo","selectedFurnitureProps","isTranslateMode","isRotateMode","changed","faBoxOpen","faSave","faTrashAlt","faUndo","faArrowsAlt","faBan","faBroom","addEventListener","beforeunload","$root","api","assign","parse","$store","getters","isSignedIn","state","userId","device","roomGraphicsQuality","findFurnitureById","$t","JSON","stringify","$nextTick","$refs","preview","roomUseOrthographicCamera","to","from","next","dialog","text","showCancelButton","canceled","destroy","removeEventListener","methods","e","preventDefault","returnValue","result","title","select","items","item","addFurniture","removeFurniture","getRoomInfo","catch","message","removeAllFurnitures","$chooseDriveFile","multiple","file","updateProp","thumbnailUrl","getSelectedObject","updateCarpetColor","changeRoomType","exit","enterTransformMode","_vm","staticClass","_v","_s","ref","_l","k","on","$event","chooseImage","domProps","updateColor","_e","translate","rotate","updateRoomType","scopedSlots","_u","fn","proxy","save"],"mappings":"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","file":"39.11.37.1.js","sourcesContent":["// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/postcss-loader/src/index.js??ref--1-oneOf-1-2!../../../../../../../node_modules/stylus-loader/index.js!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./room.vue?vue&type=style&index=0&id=1957ba12&lang=stylus&scoped=true&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"06a6abf5\", content, true, {});","module.exports = [{id:'milk',place:'floor'},{id:'bed',place:'floor'},{id:'low-table',place:'floor',props:{color:'color'},color:{Table:'color'}},{id:'desk',place:'floor',props:{color:'color'},color:{Board:'color'}},{id:'chair',place:'floor',props:{color:'color'},color:{Chair:'color'}},{id:'chair2',place:'floor',props:{color1:'color',color2:'color'},color:{Cushion:'color1',Leg:'color2'}},{id:'fan',place:'wall'},{id:'pc',place:'floor'},{id:'plant',place:'floor'},{id:'plant2',place:'floor'},{id:'eraser',place:'floor'},{id:'pencil',place:'floor'},{id:'pudding',place:'floor'},{id:'cardboard-box',place:'floor'},{id:'cardboard-box2',place:'floor'},{id:'cardboard-box3',place:'floor'},{id:'book',place:'floor',props:{color:'color'},color:{Cover:'color'}},{id:'book2',place:'floor'},{id:'piano',place:'floor'},{id:'facial-tissue',place:'floor'},{id:'server',place:'floor'},{id:'moon',place:'floor'},{id:'corkboard',place:'wall'},{id:'mousepad',place:'floor',props:{color:'color'},color:{Pad:'color'}},{id:'monitor',place:'floor',props:{screen:'image'},texture:{Screen:{prop:'screen',uv:{x:0,y:434,width:1024,height:588}}}},{id:'tv',place:'floor',props:{screen:'image'},texture:{Screen:{prop:'screen',uv:{x:0,y:434,width:1024,height:588}}}},{id:'keyboard',place:'floor'},{id:'carpet-stripe',place:'floor',props:{color1:'color',color2:'color'},color:{CarpetAreaA:'color1',CarpetAreaB:'color2'}},{id:'mat',place:'floor',props:{color:'color'},color:{Mat:'color'}},{id:'color-box',place:'floor',props:{color:'color'},color:{main:'color'}},{id:'wall-clock',place:'wall'},{id:'cube',place:'floor',props:{color:'color'},color:{Cube:'color'}},{id:'photoframe',place:'wall',props:{photo:'image',color:'color'},texture:{Photo:{prop:'photo',uv:{x:0,y:342,width:1024,height:683}}},color:{Frame:'color'}},{id:'pinguin',place:'floor',props:{body:'color',belly:'color'},color:{Body:'body',Belly:'belly'}},{id:'rubik-cube',place:'floor'},{id:'poster-h',place:'wall',props:{picture:'image'},texture:{Poster:{prop:'picture',uv:{x:0,y:277,width:1024,height:745}}}},{id:'poster-v',place:'wall',props:{picture:'image'},texture:{Poster:{prop:'picture',uv:{x:0,y:0,width:745,height:1024}}}},{id:'sofa',place:'floor',props:{color:'color'},color:{Sofa:'color'}},{id:'spiral',place:'floor',props:{color:'color'},color:{Step:'color'}},{id:'bin',place:'floor',props:{color:'color'},color:{Bin:'color'}},{id:'cup-noodle',place:'floor'},{id:'holo-display',place:'floor',props:{image:'image'},texture:{Image_Front:{prop:'image',uv:{x:0,y:0,width:1024,height:1024}},Image_Back:{prop:'image',uv:{x:0,y:0,width:1024,height:1024}}}},{id:'energy-drink',place:'floor'}]","import mod from \"-!../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/postcss-loader/src/index.js??ref--1-oneOf-1-2!../../../../../../../node_modules/stylus-loader/index.js!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./room.vue?vue&type=style&index=0&id=1957ba12&lang=stylus&scoped=true&\"; export default mod; export * from \"-!../../../../../../../node_modules/vue-style-loader/index.js!../../../../../../../node_modules/css-loader/dist/cjs.js!../../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../node_modules/postcss-loader/src/index.js??ref--1-oneOf-1-2!../../../../../../../node_modules/stylus-loader/index.js!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./room.vue?vue&type=style&index=0&id=1957ba12&lang=stylus&scoped=true&\"","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".hveuntkp>.controller[data-v-1957ba12],.hveuntkp>.menu[data-v-1957ba12]{position:fixed;z-index:1;padding:16px;background:var(--face);color:var(--text)}.hveuntkp>.controller>section[data-v-1957ba12],.hveuntkp>.menu>section[data-v-1957ba12]{padding:16px 0}.hveuntkp>.controller>section[data-v-1957ba12]:first-child,.hveuntkp>.menu>section[data-v-1957ba12]:first-child{padding-top:0}.hveuntkp>.controller>section[data-v-1957ba12]:last-child,.hveuntkp>.menu>section[data-v-1957ba12]:last-child{padding-bottom:0}.hveuntkp>.controller>section[data-v-1957ba12]:not(:last-child),.hveuntkp>.menu>section[data-v-1957ba12]:not(:last-child){border-bottom:1px solid var(--faceDivider)}.hveuntkp>.controller[data-v-1957ba12]{top:16px;left:16px;width:256px}.hveuntkp>.controller>section>.name[data-v-1957ba12]{margin:0}.hveuntkp>.menu[data-v-1957ba12]{top:16px;right:16px;width:256px}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"hveuntkp\"},[(_vm.objectSelected)?_c('div',{staticClass:\"controller\"},[_c('section',[_c('p',{staticClass:\"name\"},[_vm._v(_vm._s(_vm.selectedFurnitureName))]),_c('x-preview',{ref:\"preview\"}),(_vm.selectedFurnitureInfo.props)?_vm._l((Object.keys(_vm.selectedFurnitureInfo.props)),function(k){return _c('div',{key:k},[_c('p',[_vm._v(_vm._s(k))]),(_vm.selectedFurnitureInfo.props[k] === 'image')?[_c('ui-button',{on:{\"click\":function($event){return _vm.chooseImage(k)}}},[_vm._v(_vm._s(_vm.$t('chooseImage')))])]:(_vm.selectedFurnitureInfo.props[k] === 'color')?[_c('input',{attrs:{\"type\":\"color\"},domProps:{\"value\":_vm.selectedFurnitureProps ? _vm.selectedFurnitureProps[k] : null},on:{\"change\":function($event){return _vm.updateColor(k, $event)}}})]:_vm._e()],2)}):_vm._e()],2),_c('section',[_c('ui-button',{attrs:{\"primary\":_vm.isTranslateMode},on:{\"click\":function($event){return _vm.translate()}}},[_c('fa',{attrs:{\"icon\":_vm.faArrowsAlt}}),_vm._v(\" \"+_vm._s(_vm.$t('translate')))],1),_c('ui-button',{attrs:{\"primary\":_vm.isRotateMode},on:{\"click\":function($event){return _vm.rotate()}}},[_c('fa',{attrs:{\"icon\":_vm.faUndo}}),_vm._v(\" \"+_vm._s(_vm.$t('rotate')))],1),(_vm.isTranslateMode || _vm.isRotateMode)?_c('ui-button',{on:{\"click\":function($event){return _vm.exit()}}},[_c('fa',{attrs:{\"icon\":_vm.faBan}}),_vm._v(\" \"+_vm._s(_vm.$t('exit')))],1):_vm._e()],1),_c('section',[_c('ui-button',{on:{\"click\":function($event){return _vm.remove()}}},[_c('fa',{attrs:{\"icon\":_vm.faTrashAlt}}),_vm._v(\" \"+_vm._s(_vm.$t('remove')))],1)],1)]):_vm._e(),(_vm.isMyRoom)?_c('div',{staticClass:\"menu\"},[_c('section',[_c('ui-button',{on:{\"click\":function($event){return _vm.add()}}},[_c('fa',{attrs:{\"icon\":_vm.faBoxOpen}}),_vm._v(\" \"+_vm._s(_vm.$t('add-furniture')))],1)],1),_c('section',[_c('ui-select',{attrs:{\"value\":_vm.roomType},on:{\"input\":function($event){return _vm.updateRoomType($event)}},scopedSlots:_vm._u([{key:\"label\",fn:function(){return [_vm._v(_vm._s(_vm.$t('room-type')))]},proxy:true}],null,false,3739269933)},[_c('option',{attrs:{\"value\":\"default\"}},[_vm._v(_vm._s(_vm.$t('rooms.default')))]),_c('option',{attrs:{\"value\":\"washitsu\"}},[_vm._v(_vm._s(_vm.$t('rooms.washitsu')))])]),(_vm.roomType === 'default')?_c('label',[_c('span',[_vm._v(_vm._s(_vm.$t('carpet-color')))]),_c('input',{attrs:{\"type\":\"color\"},domProps:{\"value\":_vm.carpetColor},on:{\"change\":function($event){return _vm.updateCarpetColor($event)}}})]):_vm._e()],1),_c('section',[_c('ui-button',{attrs:{\"primary\":_vm.changed},on:{\"click\":function($event){return _vm.save()}}},[_c('fa',{attrs:{\"icon\":_vm.faSave}}),_vm._v(\" \"+_vm._s(_vm.$t('save')))],1),_c('ui-button',{on:{\"click\":function($event){return _vm.clear()}}},[_c('fa',{attrs:{\"icon\":_vm.faBroom}}),_vm._v(\" \"+_vm._s(_vm.$t('clear')))],1)],1)]):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport autobind from 'autobind-decorator';\nimport { v4 as uuid } from 'uuid';\nimport * as THREE from 'three';\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader';\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js';\nimport { EffectComposer } from 'three/examples/jsm/postprocessing/EffectComposer.js';\nimport { RenderPass } from 'three/examples/jsm/postprocessing/RenderPass.js';\nimport { ShaderPass } from 'three/examples/jsm/postprocessing/ShaderPass.js';\nimport { BloomPass } from 'three/examples/jsm/postprocessing/BloomPass.js';\nimport { FXAAShader } from 'three/examples/jsm/shaders/FXAAShader.js';\nimport { TransformControls } from 'three/examples/jsm/controls/TransformControls.js';\nimport { query as urlQuery } from '../../../../../prelude/url';\nconst furnitureDefs = require('./furnitures.json5');\nTHREE.ImageUtils.crossOrigin = '';\n/**\n * MisskeyRoom Core Engine\n */\nexport class Room {\n    constructor(user, isMyRoom, roomInfo, container, options) {\n        this.mixers = [];\n        this.objects = [];\n        this.selectedObject = null;\n        this.isTransformMode = false;\n        this.roomInfo = roomInfo;\n        this.graphicsQuality = options.graphicsQuality;\n        this.onChangeSelect = options.onChangeSelect;\n        this.clock = new THREE.Clock(true);\n        //#region Init a scene\n        this.scene = new THREE.Scene();\n        const width = window.innerWidth;\n        const height = window.innerHeight;\n        //#region Init a renderer\n        this.renderer = new THREE.WebGLRenderer({\n            antialias: false,\n            stencil: false,\n            alpha: false,\n            powerPreference: this.graphicsQuality === 'ultra' ? 'high-performance' :\n                this.graphicsQuality === 'high' ? 'high-performance' :\n                    this.graphicsQuality === 'medium' ? 'default' :\n                        this.graphicsQuality === 'low' ? 'low-power' :\n                            'low-power' // cheep\n        });\n        this.renderer.setPixelRatio(window.devicePixelRatio);\n        this.renderer.setSize(width, height);\n        this.renderer.autoClear = false;\n        this.renderer.setClearColor(new THREE.Color(0x051f2d));\n        this.renderer.shadowMap.enabled = this.enableShadow;\n        this.renderer.shadowMap.type =\n            this.graphicsQuality === 'ultra' ? THREE.PCFSoftShadowMap :\n                this.graphicsQuality === 'high' ? THREE.PCFSoftShadowMap :\n                    this.graphicsQuality === 'medium' ? THREE.PCFShadowMap :\n                        this.graphicsQuality === 'low' ? THREE.BasicShadowMap :\n                            THREE.BasicShadowMap; // cheep\n        container.appendChild(this.canvas);\n        //#endregion\n        //#region Init a camera\n        this.camera = options.useOrthographicCamera\n            ? new THREE.OrthographicCamera(width / -2, width / 2, height / 2, height / -2, -10, 10)\n            : new THREE.PerspectiveCamera(45, width / height);\n        if (options.useOrthographicCamera) {\n            this.camera.position.x = 2;\n            this.camera.position.y = 2;\n            this.camera.position.z = 2;\n            this.camera.zoom = 100;\n            this.camera.updateProjectionMatrix();\n        }\n        else {\n            this.camera.position.x = 5;\n            this.camera.position.y = 2;\n            this.camera.position.z = 5;\n        }\n        this.scene.add(this.camera);\n        //#endregion\n        //#region AmbientLight\n        const ambientLight = new THREE.AmbientLight(0xffffff, 1);\n        this.scene.add(ambientLight);\n        //#endregion\n        if (this.graphicsQuality !== 'cheep') {\n            //#region Room light\n            const roomLight = new THREE.SpotLight(0xffffff, 0.1);\n            roomLight.position.set(0, 8, 0);\n            roomLight.castShadow = this.enableShadow;\n            roomLight.shadow.bias = -0.0001;\n            roomLight.shadow.mapSize.width = this.shadowQuality;\n            roomLight.shadow.mapSize.height = this.shadowQuality;\n            roomLight.shadow.camera.near = 0.1;\n            roomLight.shadow.camera.far = 9;\n            roomLight.shadow.camera.fov = 45;\n            this.scene.add(roomLight);\n            //#endregion\n        }\n        //#region Out light\n        const outLight1 = new THREE.SpotLight(0xffffff, 0.4);\n        outLight1.position.set(9, 3, -2);\n        outLight1.castShadow = this.enableShadow;\n        outLight1.shadow.bias = -0.001; // アクネ、アーチファクト対策 その代わりピーターパンが発生する可能性がある\n        outLight1.shadow.mapSize.width = this.shadowQuality;\n        outLight1.shadow.mapSize.height = this.shadowQuality;\n        outLight1.shadow.camera.near = 6;\n        outLight1.shadow.camera.far = 15;\n        outLight1.shadow.camera.fov = 45;\n        this.scene.add(outLight1);\n        const outLight2 = new THREE.SpotLight(0xffffff, 0.2);\n        outLight2.position.set(-2, 3, 9);\n        outLight2.castShadow = false;\n        outLight2.shadow.bias = -0.001; // アクネ、アーチファクト対策 その代わりピーターパンが発生する可能性がある\n        outLight2.shadow.camera.near = 6;\n        outLight2.shadow.camera.far = 15;\n        outLight2.shadow.camera.fov = 45;\n        this.scene.add(outLight2);\n        //#endregion\n        //#region Init a controller\n        this.controls = new OrbitControls(this.camera, this.canvas);\n        this.controls.target.set(0, 1, 0);\n        this.controls.enableZoom = true;\n        this.controls.enablePan = isMyRoom;\n        this.controls.minPolarAngle = 0;\n        this.controls.maxPolarAngle = Math.PI / 2;\n        this.controls.minAzimuthAngle = 0;\n        this.controls.maxAzimuthAngle = Math.PI / 2;\n        this.controls.enableDamping = true;\n        this.controls.dampingFactor = 0.2;\n        this.controls.mouseButtons.LEFT = 1;\n        this.controls.mouseButtons.MIDDLE = 2;\n        this.controls.mouseButtons.RIGHT = 0;\n        //#endregion\n        //#region POST FXs\n        if (!this.usePostFXs) {\n            this.composer = null;\n        }\n        else {\n            const renderTarget = new THREE.WebGLRenderTarget(width, height, {\n                minFilter: THREE.LinearFilter,\n                magFilter: THREE.LinearFilter,\n                format: THREE.RGBFormat,\n                stencilBuffer: false,\n            });\n            const fxaa = new ShaderPass(FXAAShader);\n            fxaa.uniforms['resolution'].value = new THREE.Vector2(1 / width, 1 / height);\n            fxaa.renderToScreen = true;\n            this.composer = new EffectComposer(this.renderer, renderTarget);\n            this.composer.addPass(new RenderPass(this.scene, this.camera));\n            if (this.graphicsQuality === 'ultra') {\n                this.composer.addPass(new BloomPass(0.25, 30, 128.0, 512));\n            }\n            this.composer.addPass(fxaa);\n        }\n        //#endregion\n        //#endregion\n        //#region Label\n        //#region Avatar\n        const avatarUrl = `/proxy/?${urlQuery({ url: user.avatarUrl })}`;\n        const textureLoader = new THREE.TextureLoader();\n        textureLoader.crossOrigin = 'anonymous';\n        const iconTexture = textureLoader.load(avatarUrl);\n        iconTexture.wrapS = THREE.RepeatWrapping;\n        iconTexture.wrapT = THREE.RepeatWrapping;\n        iconTexture.anisotropy = 16;\n        const avatarMaterial = new THREE.MeshBasicMaterial({\n            map: iconTexture,\n            side: THREE.DoubleSide,\n            alphaTest: 0.5\n        });\n        const iconGeometry = new THREE.PlaneGeometry(1, 1);\n        const avatarObject = new THREE.Mesh(iconGeometry, avatarMaterial);\n        avatarObject.position.set(-3, 2.5, 2);\n        avatarObject.rotation.y = Math.PI / 2;\n        avatarObject.castShadow = false;\n        this.scene.add(avatarObject);\n        //#endregion\n        //#region Username\n        const name = user.username;\n        new THREE.FontLoader().load('/assets/fonts/helvetiker_regular.typeface.json', font => {\n            const nameGeometry = new THREE.TextGeometry(name, {\n                size: 0.5,\n                height: 0,\n                curveSegments: 8,\n                font: font,\n                bevelThickness: 0,\n                bevelSize: 0,\n                bevelEnabled: false\n            });\n            const nameMaterial = new THREE.MeshLambertMaterial({\n                color: 0xffffff\n            });\n            const nameObject = new THREE.Mesh(nameGeometry, nameMaterial);\n            nameObject.position.set(-3, 2.25, 1.25);\n            nameObject.rotation.y = Math.PI / 2;\n            nameObject.castShadow = false;\n            this.scene.add(nameObject);\n        });\n        //#endregion\n        //#endregion\n        //#region Interaction\n        if (isMyRoom) {\n            this.furnitureControl = new TransformControls(this.camera, this.canvas);\n            this.scene.add(this.furnitureControl);\n            // Hover highlight\n            this.canvas.onmousemove = this.onmousemove;\n            // Click\n            this.canvas.onmousedown = this.onmousedown;\n        }\n        //#endregion\n        //#region Init room\n        this.loadRoom();\n        //#endregion\n        //#region Load furnitures\n        for (const furniture of this.furnitures) {\n            this.loadFurniture(furniture).then(obj => {\n                this.scene.add(obj.scene);\n                this.objects.push(obj.scene);\n            });\n        }\n        //#endregion\n        // Start render\n        if (this.usePostFXs) {\n            this.renderWithPostFXs();\n        }\n        else {\n            this.renderWithoutPostFXs();\n        }\n    }\n    get canvas() {\n        return this.renderer.domElement;\n    }\n    get furnitures() {\n        return this.roomInfo.furnitures;\n    }\n    set furnitures(furnitures) {\n        this.roomInfo.furnitures = furnitures;\n    }\n    get enableShadow() {\n        return this.graphicsQuality != 'cheep';\n    }\n    get usePostFXs() {\n        return this.graphicsQuality !== 'cheep' && this.graphicsQuality !== 'low';\n    }\n    get shadowQuality() {\n        return (this.graphicsQuality === 'ultra' ? 16384 :\n            this.graphicsQuality === 'high' ? 8192 :\n                this.graphicsQuality === 'medium' ? 4096 :\n                    this.graphicsQuality === 'low' ? 1024 :\n                        0); // cheep\n    }\n    renderWithoutPostFXs() {\n        this.renderFrameRequestId =\n            window.requestAnimationFrame(this.renderWithoutPostFXs);\n        // Update animations\n        const clock = this.clock.getDelta();\n        for (const mixer of this.mixers) {\n            mixer.update(clock);\n        }\n        this.controls.update();\n        this.renderer.render(this.scene, this.camera);\n    }\n    renderWithPostFXs() {\n        this.renderFrameRequestId =\n            window.requestAnimationFrame(this.renderWithPostFXs);\n        // Update animations\n        const clock = this.clock.getDelta();\n        for (const mixer of this.mixers) {\n            mixer.update(clock);\n        }\n        this.controls.update();\n        this.renderer.clear();\n        this.composer.render();\n    }\n    loadRoom() {\n        const type = this.roomInfo.roomType;\n        new GLTFLoader().load(`/assets/room/rooms/${type}/${type}.glb`, gltf => {\n            gltf.scene.traverse(child => {\n                if (!(child instanceof THREE.Mesh))\n                    return;\n                child.receiveShadow = this.enableShadow;\n                child.material = new THREE.MeshLambertMaterial({\n                    color: child.material.color,\n                    map: child.material.map,\n                    name: child.material.name,\n                });\n                // 異方性フィルタリング\n                if (child.material.map && this.graphicsQuality !== 'cheep') {\n                    child.material.map.minFilter = THREE.LinearMipMapLinearFilter;\n                    child.material.map.magFilter = THREE.LinearMipMapLinearFilter;\n                    child.material.map.anisotropy = 8;\n                }\n            });\n            gltf.scene.position.set(0, 0, 0);\n            this.scene.add(gltf.scene);\n            this.roomObj = gltf.scene;\n            if (this.roomInfo.roomType === 'default') {\n                this.applyCarpetColor();\n            }\n        });\n    }\n    loadFurniture(furniture) {\n        const def = furnitureDefs.find(d => d.id === furniture.type);\n        return new Promise((res, rej) => {\n            const loader = new GLTFLoader();\n            loader.load(`/assets/room/furnitures/${furniture.type}/${furniture.type}.glb`, gltf => {\n                const model = gltf.scene;\n                // Load animation\n                if (gltf.animations.length > 0) {\n                    const mixer = new THREE.AnimationMixer(model);\n                    this.mixers.push(mixer);\n                    for (const clip of gltf.animations) {\n                        mixer.clipAction(clip).play();\n                    }\n                }\n                model.name = furniture.id;\n                model.position.x = furniture.position.x;\n                model.position.y = furniture.position.y;\n                model.position.z = furniture.position.z;\n                model.rotation.x = furniture.rotation.x;\n                model.rotation.y = furniture.rotation.y;\n                model.rotation.z = furniture.rotation.z;\n                model.traverse(child => {\n                    if (!(child instanceof THREE.Mesh))\n                        return;\n                    child.castShadow = this.enableShadow;\n                    child.receiveShadow = this.enableShadow;\n                    child.material.metalness = 0;\n                    // 異方性フィルタリング\n                    if (child.material.map && this.graphicsQuality !== 'cheep') {\n                        child.material.map.minFilter = THREE.LinearMipMapLinearFilter;\n                        child.material.map.magFilter = THREE.LinearMipMapLinearFilter;\n                        child.material.map.anisotropy = 8;\n                    }\n                });\n                if (def.color) { // カスタムカラー\n                    this.applyCustomColor(model);\n                }\n                if (def.texture) { // カスタムテクスチャ\n                    this.applyCustomTexture(model);\n                }\n                res(gltf);\n            }, null, rej);\n        });\n    }\n    applyCarpetColor() {\n        this.roomObj.traverse(child => {\n            if (!(child instanceof THREE.Mesh))\n                return;\n            if (child.material &&\n                child.material.name &&\n                child.material.name === 'Carpet') {\n                const colorHex = parseInt(this.roomInfo.carpetColor.substr(1), 16);\n                child.material.color.setHex(colorHex);\n            }\n        });\n    }\n    applyCustomColor(model) {\n        const furniture = this.furnitures.find(furniture => furniture.id === model.name);\n        const def = furnitureDefs.find(d => d.id === furniture.type);\n        if (def.color == null)\n            return;\n        model.traverse(child => {\n            if (!(child instanceof THREE.Mesh))\n                return;\n            for (const t of Object.keys(def.color)) {\n                if (!child.material ||\n                    !child.material.name ||\n                    child.material.name !== t)\n                    continue;\n                const prop = def.color[t];\n                const val = furniture.props ? furniture.props[prop] : undefined;\n                if (val == null)\n                    continue;\n                const colorHex = parseInt(val.substr(1), 16);\n                child.material.color.setHex(colorHex);\n            }\n        });\n    }\n    applyCustomTexture(model) {\n        const furniture = this.furnitures.find(furniture => furniture.id === model.name);\n        const def = furnitureDefs.find(d => d.id === furniture.type);\n        if (def.texture == null)\n            return;\n        model.traverse(child => {\n            if (!(child instanceof THREE.Mesh))\n                return;\n            for (const t of Object.keys(def.texture)) {\n                if (child.name !== t)\n                    continue;\n                const prop = def.texture[t].prop;\n                const val = furniture.props ? furniture.props[prop] : undefined;\n                if (val == null)\n                    continue;\n                const canvas = document.createElement('canvas');\n                canvas.height = 1024;\n                canvas.width = 1024;\n                child.material = new THREE.MeshLambertMaterial({\n                    emissive: 0x111111,\n                    side: THREE.DoubleSide,\n                    alphaTest: 0.5,\n                });\n                const img = new Image();\n                img.crossOrigin = 'anonymous';\n                img.onload = () => {\n                    const uvInfo = def.texture[t].uv;\n                    const ctx = canvas.getContext('2d');\n                    ctx.drawImage(img, 0, 0, img.width, img.height, uvInfo.x, uvInfo.y, uvInfo.width, uvInfo.height);\n                    const texture = new THREE.Texture(canvas);\n                    texture.wrapS = THREE.RepeatWrapping;\n                    texture.wrapT = THREE.RepeatWrapping;\n                    texture.anisotropy = 16;\n                    texture.flipY = false;\n                    child.material.map = texture;\n                    child.material.needsUpdate = true;\n                    child.material.map.needsUpdate = true;\n                };\n                img.src = val;\n            }\n        });\n    }\n    onmousemove(ev) {\n        if (this.isTransformMode)\n            return;\n        const rect = ev.target.getBoundingClientRect();\n        const x = (((ev.clientX * window.devicePixelRatio) - rect.left) / this.canvas.width) * 2 - 1;\n        const y = -(((ev.clientY * window.devicePixelRatio) - rect.top) / this.canvas.height) * 2 + 1;\n        const pos = new THREE.Vector2(x, y);\n        this.camera.updateMatrixWorld();\n        const raycaster = new THREE.Raycaster();\n        raycaster.setFromCamera(pos, this.camera);\n        const intersects = raycaster.intersectObjects(this.objects, true);\n        for (const object of this.objects) {\n            if (this.isSelectedObject(object))\n                continue;\n            object.traverse(child => {\n                if (child instanceof THREE.Mesh) {\n                    child.material.emissive.setHex(0x000000);\n                }\n            });\n        }\n        if (intersects.length > 0) {\n            const intersected = this.getRoot(intersects[0].object);\n            if (this.isSelectedObject(intersected))\n                return;\n            intersected.traverse(child => {\n                if (child instanceof THREE.Mesh) {\n                    child.material.emissive.setHex(0x191919);\n                }\n            });\n        }\n    }\n    onmousedown(ev) {\n        if (this.isTransformMode)\n            return;\n        if (ev.target !== this.canvas || ev.button !== 0)\n            return;\n        const rect = ev.target.getBoundingClientRect();\n        const x = (((ev.clientX * window.devicePixelRatio) - rect.left) / this.canvas.width) * 2 - 1;\n        const y = -(((ev.clientY * window.devicePixelRatio) - rect.top) / this.canvas.height) * 2 + 1;\n        const pos = new THREE.Vector2(x, y);\n        this.camera.updateMatrixWorld();\n        const raycaster = new THREE.Raycaster();\n        raycaster.setFromCamera(pos, this.camera);\n        const intersects = raycaster.intersectObjects(this.objects, true);\n        for (const object of this.objects) {\n            object.traverse(child => {\n                if (child instanceof THREE.Mesh) {\n                    child.material.emissive.setHex(0x000000);\n                }\n            });\n        }\n        if (intersects.length > 0) {\n            const selectedObj = this.getRoot(intersects[0].object);\n            this.selectFurniture(selectedObj);\n        }\n        else {\n            this.selectedObject = null;\n            this.onChangeSelect(null);\n        }\n    }\n    getRoot(obj) {\n        let found = false;\n        let x = obj.parent;\n        while (!found) {\n            if (x.parent.parent == null) {\n                found = true;\n            }\n            else {\n                x = x.parent;\n            }\n        }\n        return x;\n    }\n    isSelectedObject(obj) {\n        if (this.selectedObject == null) {\n            return false;\n        }\n        else {\n            return obj.name === this.selectedObject.name;\n        }\n    }\n    selectFurniture(obj) {\n        this.selectedObject = obj;\n        this.onChangeSelect(obj);\n        obj.traverse(child => {\n            if (child instanceof THREE.Mesh) {\n                child.material.emissive.setHex(0xff0000);\n            }\n        });\n    }\n    /**\n     * 家具の移動/回転モードにします\n     * @param type 移動か回転か\n     */\n    enterTransformMode(type) {\n        this.isTransformMode = true;\n        this.furnitureControl.setMode(type);\n        this.furnitureControl.attach(this.selectedObject);\n    }\n    /**\n     * 家具の移動/回転モードを終了します\n     */\n    exitTransformMode() {\n        this.isTransformMode = false;\n        this.furnitureControl.detach();\n    }\n    /**\n     * 家具プロパティを更新します\n     * @param key プロパティ名\n     * @param value 値\n     */\n    updateProp(key, value) {\n        const furniture = this.furnitures.find(furniture => furniture.id === this.selectedObject.name);\n        if (furniture.props == null)\n            furniture.props = {};\n        furniture.props[key] = value;\n        this.applyCustomColor(this.selectedObject);\n        this.applyCustomTexture(this.selectedObject);\n    }\n    /**\n     * 部屋に家具を追加します\n     * @param type 家具の種類\n     */\n    addFurniture(type) {\n        const furniture = {\n            id: uuid(),\n            type: type,\n            position: {\n                x: 0,\n                y: 0,\n                z: 0,\n            },\n            rotation: {\n                x: 0,\n                y: 0,\n                z: 0,\n            },\n        };\n        this.furnitures.push(furniture);\n        this.loadFurniture(furniture).then(obj => {\n            this.scene.add(obj.scene);\n            this.objects.push(obj.scene);\n        });\n    }\n    /**\n     * 現在選択されている家具を部屋から削除します\n     */\n    removeFurniture() {\n        this.exitTransformMode();\n        const obj = this.selectedObject;\n        this.scene.remove(obj);\n        this.objects = this.objects.filter(object => object.name !== obj.name);\n        this.furnitures = this.furnitures.filter(furniture => furniture.id !== obj.name);\n        this.selectedObject = null;\n        this.onChangeSelect(null);\n    }\n    /**\n     * 全ての家具を部屋から削除します\n     */\n    removeAllFurnitures() {\n        this.exitTransformMode();\n        for (const obj of this.objects) {\n            this.scene.remove(obj);\n        }\n        this.objects = [];\n        this.furnitures = [];\n        this.selectedObject = null;\n        this.onChangeSelect(null);\n    }\n    /**\n     * 部屋の床の色を変更します\n     * @param color 色\n     */\n    updateCarpetColor(color) {\n        this.roomInfo.carpetColor = color;\n        this.applyCarpetColor();\n    }\n    /**\n     * 部屋の種類を変更します\n     * @param type 種類\n     */\n    changeRoomType(type) {\n        this.roomInfo.roomType = type;\n        this.scene.remove(this.roomObj);\n        this.loadRoom();\n    }\n    /**\n     * 部屋データを取得します\n     */\n    getRoomInfo() {\n        for (const obj of this.objects) {\n            const furniture = this.furnitures.find(f => f.id === obj.name);\n            furniture.position.x = obj.position.x;\n            furniture.position.y = obj.position.y;\n            furniture.position.z = obj.position.z;\n            furniture.rotation.x = obj.rotation.x;\n            furniture.rotation.y = obj.rotation.y;\n            furniture.rotation.z = obj.rotation.z;\n        }\n        return this.roomInfo;\n    }\n    /**\n     * 選択されている家具を取得します\n     */\n    getSelectedObject() {\n        return this.selectedObject;\n    }\n    findFurnitureById(id) {\n        return this.furnitures.find(furniture => furniture.id === id);\n    }\n    /**\n     * レンダリングを終了します\n     */\n    destroy() {\n        // Stop render loop\n        window.cancelAnimationFrame(this.renderFrameRequestId);\n        this.controls.dispose();\n        this.scene.dispose();\n    }\n}\n__decorate([\n    autobind\n], Room.prototype, \"renderWithoutPostFXs\", null);\n__decorate([\n    autobind\n], Room.prototype, \"renderWithPostFXs\", null);\n__decorate([\n    autobind\n], Room.prototype, \"loadRoom\", null);\n__decorate([\n    autobind\n], Room.prototype, \"loadFurniture\", null);\n__decorate([\n    autobind\n], Room.prototype, \"applyCarpetColor\", null);\n__decorate([\n    autobind\n], Room.prototype, \"applyCustomColor\", null);\n__decorate([\n    autobind\n], Room.prototype, \"applyCustomTexture\", null);\n__decorate([\n    autobind\n], Room.prototype, \"onmousemove\", null);\n__decorate([\n    autobind\n], Room.prototype, \"onmousedown\", null);\n__decorate([\n    autobind\n], Room.prototype, \"getRoot\", null);\n__decorate([\n    autobind\n], Room.prototype, \"isSelectedObject\", null);\n__decorate([\n    autobind\n], Room.prototype, \"selectFurniture\", null);\n__decorate([\n    autobind\n], Room.prototype, \"enterTransformMode\", null);\n__decorate([\n    autobind\n], Room.prototype, \"exitTransformMode\", null);\n__decorate([\n    autobind\n], Room.prototype, \"updateProp\", null);\n__decorate([\n    autobind\n], Room.prototype, \"addFurniture\", null);\n__decorate([\n    autobind\n], Room.prototype, \"removeFurniture\", null);\n__decorate([\n    autobind\n], Room.prototype, \"removeAllFurnitures\", null);\n__decorate([\n    autobind\n], Room.prototype, \"updateCarpetColor\", null);\n__decorate([\n    autobind\n], Room.prototype, \"changeRoomType\", null);\n__decorate([\n    autobind\n], Room.prototype, \"getRoomInfo\", null);\n__decorate([\n    autobind\n], Room.prototype, \"getSelectedObject\", null);\n__decorate([\n    autobind\n], Room.prototype, \"findFurnitureById\", null);\n__decorate([\n    autobind\n], Room.prototype, \"destroy\", null);\n","import mod from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--5-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./preview.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--5-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./preview.vue?vue&type=script&lang=ts&\"","import Vue from 'vue';\nimport * as THREE from 'three';\nexport default Vue.extend({\n    data() {\n        return {\n            selected: null,\n            objectHeight: 0,\n            orbitRadius: 5\n        };\n    },\n    mounted() {\n        const canvas = this.$el;\n        const width = canvas.width;\n        const height = canvas.height;\n        const scene = new THREE.Scene();\n        const renderer = new THREE.WebGLRenderer({\n            canvas: canvas,\n            antialias: true,\n            alpha: false\n        });\n        renderer.setPixelRatio(window.devicePixelRatio);\n        renderer.setSize(width, height);\n        renderer.setClearColor(0x000000);\n        renderer.autoClear = false;\n        renderer.shadowMap.enabled = true;\n        renderer.shadowMap.cullFace = THREE.CullFaceBack;\n        const camera = new THREE.PerspectiveCamera(75, width / height, 0.1, 100);\n        camera.zoom = 10;\n        camera.position.x = 0;\n        camera.position.y = 2;\n        camera.position.z = 0;\n        camera.updateProjectionMatrix();\n        scene.add(camera);\n        const ambientLight = new THREE.AmbientLight(0xffffff, 1);\n        ambientLight.castShadow = false;\n        scene.add(ambientLight);\n        const light = new THREE.PointLight(0xffffff, 1, 100);\n        light.position.set(3, 3, 3);\n        scene.add(light);\n        const grid = new THREE.GridHelper(5, 16, 0x444444, 0x222222);\n        scene.add(grid);\n        const render = () => {\n            const timer = Date.now() * 0.0004;\n            requestAnimationFrame(render);\n            camera.position.y = Math.sin(Math.PI / 6) * this.orbitRadius; // Math.PI / 6 => 30deg\n            camera.position.z = Math.cos(timer) * this.orbitRadius;\n            camera.position.x = Math.sin(timer) * this.orbitRadius;\n            camera.lookAt(new THREE.Vector3(0, this.objectHeight / 2, 0));\n            renderer.render(scene, camera);\n        };\n        this.selected = selected => {\n            const obj = selected.clone();\n            // Remove current object\n            const current = scene.getObjectByName('obj');\n            if (current != null) {\n                scene.remove(current);\n            }\n            // Add new object\n            obj.name = 'obj';\n            obj.position.x = 0;\n            obj.position.y = 0;\n            obj.position.z = 0;\n            obj.rotation.x = 0;\n            obj.rotation.y = 0;\n            obj.rotation.z = 0;\n            obj.traverse(child => {\n                if (child instanceof THREE.Mesh) {\n                    child.material = child.material.clone();\n                    return child.material.emissive.setHex(0x000000);\n                }\n            });\n            const objectBoundingBox = new THREE.Box3().setFromObject(obj);\n            this.objectHeight = objectBoundingBox.max.y - objectBoundingBox.min.y;\n            const objectWidth = objectBoundingBox.max.x - objectBoundingBox.min.x;\n            const objectDepth = objectBoundingBox.max.z - objectBoundingBox.min.z;\n            const horizontal = Math.hypot(objectWidth, objectDepth) / camera.aspect;\n            this.orbitRadius = Math.max(horizontal, this.objectHeight) * camera.zoom * 0.625 / Math.tan(camera.fov * 0.5 * (Math.PI / 180));\n            scene.add(obj);\n        };\n        render();\n    },\n});\n","import { render, staticRenderFns } from \"./preview.vue?vue&type=template&id=a9872372&\"\nimport script from \"./preview.vue?vue&type=script&lang=ts&\"\nexport * from \"./preview.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('canvas',{attrs:{\"width\":\"224\",\"height\":\"128\"}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import Vue from 'vue';\nimport i18n from '../../../../i18n';\nimport { Room } from '../../../scripts/room/room';\nimport parseAcct from '../../../../../../misc/acct/parse';\nimport XPreview from './preview.vue';\nconst storeItems = require('../../../scripts/room/furnitures.json5');\nimport { faBoxOpen, faUndo, faArrowsAlt, faBan, faBroom } from '@fortawesome/free-solid-svg-icons';\nimport { faSave, faTrashAlt } from '@fortawesome/free-regular-svg-icons';\nimport { query as urlQuery } from '../../../../../../prelude/url';\nlet room;\nexport default Vue.extend({\n    i18n: i18n('room'),\n    components: {\n        XPreview\n    },\n    props: {\n        acct: {\n            type: String,\n            required: true\n        },\n    },\n    data() {\n        return {\n            objectSelected: false,\n            selectedFurnitureName: null,\n            selectedFurnitureInfo: null,\n            selectedFurnitureProps: null,\n            roomType: null,\n            carpetColor: null,\n            isTranslateMode: false,\n            isRotateMode: false,\n            isMyRoom: false,\n            changed: false,\n            faBoxOpen, faSave, faTrashAlt, faUndo, faArrowsAlt, faBan, faBroom,\n        };\n    },\n    async mounted() {\n        window.addEventListener('beforeunload', this.beforeunload);\n        const user = await this.$root.api('users/show', Object.assign({}, parseAcct(this.acct)));\n        this.isMyRoom = this.$store.getters.isSignedIn && this.$store.state.i.id === user.id;\n        const roomInfo = await this.$root.api('room/show', {\n            userId: user.id\n        });\n        this.roomType = roomInfo.roomType;\n        this.carpetColor = roomInfo.carpetColor;\n        room = new Room(user, this.isMyRoom, roomInfo, this.$el, {\n            graphicsQuality: this.$store.state.device.roomGraphicsQuality,\n            onChangeSelect: obj => {\n                this.objectSelected = obj != null;\n                if (obj) {\n                    const f = room.findFurnitureById(obj.name);\n                    this.selectedFurnitureName = this.$t('furnitures.' + f.type);\n                    this.selectedFurnitureInfo = storeItems.find(x => x.id === f.type);\n                    this.selectedFurnitureProps = f.props\n                        ? JSON.parse(JSON.stringify(f.props)) // Disable reactivity\n                        : null;\n                    this.$nextTick(() => {\n                        this.$refs.preview.selected(obj);\n                    });\n                }\n            },\n            useOrthographicCamera: this.$store.state.device.roomUseOrthographicCamera\n        });\n    },\n    beforeRouteLeave(to, from, next) {\n        if (this.changed) {\n            this.$root.dialog({\n                type: 'warning',\n                text: this.$t('leave-confirm'),\n                showCancelButton: true\n            }).then(({ canceled }) => {\n                if (canceled) {\n                    next(false);\n                }\n                else {\n                    next();\n                }\n            });\n        }\n        else {\n            next();\n        }\n    },\n    beforeDestroy() {\n        room.destroy();\n        window.removeEventListener('beforeunload', this.beforeunload);\n    },\n    methods: {\n        beforeunload(e) {\n            if (this.changed) {\n                e.preventDefault();\n                e.returnValue = '';\n            }\n        },\n        async add() {\n            const { canceled, result: id } = await this.$root.dialog({\n                type: null,\n                title: this.$t('add-furniture'),\n                select: {\n                    items: storeItems.map(item => ({\n                        value: item.id, text: this.$t('furnitures.' + item.id)\n                    }))\n                },\n                showCancelButton: true\n            });\n            if (canceled)\n                return;\n            room.addFurniture(id);\n            this.changed = true;\n        },\n        remove() {\n            this.isTranslateMode = false;\n            this.isRotateMode = false;\n            room.removeFurniture();\n            this.changed = true;\n        },\n        save() {\n            this.$root.api('room/update', {\n                room: room.getRoomInfo()\n            }).then(() => {\n                this.changed = false;\n                this.$root.dialog({\n                    type: 'success',\n                    text: this.$t('saved')\n                });\n            }).catch((e) => {\n                this.$root.dialog({\n                    type: 'error',\n                    text: e.message\n                });\n            });\n        },\n        clear() {\n            this.$root.dialog({\n                type: 'warning',\n                text: this.$t('clear-confirm'),\n                showCancelButton: true\n            }).then(({ canceled }) => {\n                if (canceled)\n                    return;\n                room.removeAllFurnitures();\n                this.changed = true;\n            });\n        },\n        chooseImage(key) {\n            this.$chooseDriveFile({\n                multiple: false\n            }).then(file => {\n                room.updateProp(key, `/proxy/?${urlQuery({ url: file.thumbnailUrl })}`);\n                this.$refs.preview.selected(room.getSelectedObject());\n                this.changed = true;\n            });\n        },\n        updateColor(key, ev) {\n            room.updateProp(key, ev.target.value);\n            this.$refs.preview.selected(room.getSelectedObject());\n            this.changed = true;\n        },\n        updateCarpetColor(ev) {\n            room.updateCarpetColor(ev.target.value);\n            this.carpetColor = ev.target.value;\n            this.changed = true;\n        },\n        updateRoomType(type) {\n            room.changeRoomType(type);\n            this.roomType = type;\n            this.changed = true;\n        },\n        translate() {\n            if (this.isTranslateMode) {\n                this.exit();\n            }\n            else {\n                this.isRotateMode = false;\n                this.isTranslateMode = true;\n                room.enterTransformMode('translate');\n            }\n            this.changed = true;\n        },\n        rotate() {\n            if (this.isRotateMode) {\n                this.exit();\n            }\n            else {\n                this.isTranslateMode = false;\n                this.isRotateMode = true;\n                room.enterTransformMode('rotate');\n            }\n            this.changed = true;\n        },\n        exit() {\n            this.isTranslateMode = false;\n            this.isRotateMode = false;\n            room.exitTransformMode();\n            this.changed = true;\n        }\n    }\n});\n","import mod from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--5-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./room.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../../node_modules/ts-loader/index.js??ref--5-0!../../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./room.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./room.vue?vue&type=template&id=1957ba12&scoped=true&\"\nimport script from \"./room.vue?vue&type=script&lang=ts&\"\nexport * from \"./room.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./room.vue?vue&type=style&index=0&id=1957ba12&lang=stylus&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1957ba12\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}