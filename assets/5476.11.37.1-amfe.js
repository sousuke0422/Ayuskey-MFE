(self.webpackChunkayuskey_mfe=self.webpackChunkayuskey_mfe||[]).push([[5476],{66464:(e,t,a)=>{var o=a(94015),s=a(23645)(o);s.push([e.id,".mk-autocomplete[data-v-56ea362e]{position:fixed;z-index:65535;max-width:100%;margin-top:calc(1em + 8px);overflow:hidden;background:var(--faceHeader);border:1px solid rgba(0,0,0,.1);border-radius:4px;transition:top .1s ease,left .1s ease}.mk-autocomplete>ol[data-v-56ea362e]{display:block;margin:0;padding:4px 0;max-height:190px;max-width:500px;overflow:auto;list-style:none}.mk-autocomplete>ol>li[data-v-56ea362e]{display:flex;align-items:center;padding:4px 12px;white-space:nowrap;overflow:hidden;font-size:.9em;color:rgba(0,0,0,.8);cursor:default}.mk-autocomplete>ol>li[data-v-56ea362e],.mk-autocomplete>ol>li *[data-v-56ea362e]{user-select:none}.mk-autocomplete>ol>li *[data-v-56ea362e]{overflow:hidden;text-overflow:ellipsis}.mk-autocomplete>ol>li[data-v-56ea362e]:hover{background:var(--autocompleteItemHoverBg)}.mk-autocomplete>ol>li[data-selected=true][data-v-56ea362e]{background:var(--primary)}.mk-autocomplete>ol>li[data-selected=true][data-v-56ea362e],.mk-autocomplete>ol>li[data-selected=true] *[data-v-56ea362e]{color:#fff!important}.mk-autocomplete>ol>li[data-v-56ea362e]:active{background:var(--primaryDarken10)}.mk-autocomplete>ol>li[data-v-56ea362e]:active,.mk-autocomplete>ol>li:active *[data-v-56ea362e]{color:#fff!important}.mk-autocomplete>.users>li .avatar[data-v-56ea362e]{min-width:28px;min-height:28px;max-width:28px;max-height:28px;margin:0 8px 0 0;border-radius:100%}.mk-autocomplete>.users>li .name[data-v-56ea362e]{margin:0 8px 0 0;color:var(--autocompleteItemText)}.mk-autocomplete>.users>li .username[data-v-56ea362e]{color:var(--autocompleteItemTextSub)}.mk-autocomplete>.hashtags>li .name[data-v-56ea362e]{color:var(--autocompleteItemText)}.mk-autocomplete>.emojis>li .emoji[data-v-56ea362e]{display:inline-block;margin:0 4px 0 0;width:24px}.mk-autocomplete>.emojis>li .emoji>img[data-v-56ea362e]{width:24px;vertical-align:bottom}.mk-autocomplete>.emojis>li .name[data-v-56ea362e]{color:var(--autocompleteItemText)}.mk-autocomplete>.emojis>li .alias[data-v-56ea362e]{margin:0 0 0 8px;color:var(--autocompleteItemTextSub)}","",{version:3,sources:["webpack://./src/client/app/common/views/components/autocomplete.vue"],names:[],mappings:"AAAA,kCAAkC,cAAc,CAAC,aAAa,CAAC,cAAc,CAAC,0BAA0B,CAAC,eAAe,CAAC,4BAA4B,CAAC,+BAA+B,CAAC,iBAAiB,CAAC,qCAAqC,CAAC,qCAAqC,aAAa,CAAC,QAAQ,CAAC,aAAa,CAAC,gBAAgB,CAAC,eAAe,CAAC,aAAa,CAAC,eAAe,CAAC,wCAAwC,YAAY,CAAC,kBAAkB,CAAC,gBAAgB,CAAC,kBAAkB,CAAC,eAAe,CAAC,cAAc,CAAC,oBAAoB,CAAC,cAAc,CAAC,kFAAkF,gBAAgB,CAAC,0CAA0C,eAAe,CAAC,sBAAsB,CAAC,8CAA8C,yCAAyC,CAAC,4DAA4D,yBAAyB,CAAC,0HAA0H,oBAAoB,CAAC,+CAA+C,iCAAiC,CAAC,gGAAgG,oBAAoB,CAAC,oDAAoD,cAAc,CAAC,eAAe,CAAC,cAAc,CAAC,eAAe,CAAC,gBAAgB,CAAC,kBAAkB,CAAC,kDAAkD,gBAAgB,CAAC,iCAAiC,CAAC,sDAAsD,oCAAoC,CAAC,qDAAqD,iCAAiC,CAAC,oDAAoD,oBAAoB,CAAC,gBAAgB,CAAC,UAAU,CAAC,wDAAwD,UAAU,CAAC,qBAAqB,CAAC,mDAAmD,iCAAiC,CAAC,oDAAoD,gBAAgB,CAAC,oCAAoC",sourcesContent:[".mk-autocomplete[data-v-56ea362e]{position:fixed;z-index:65535;max-width:100%;margin-top:calc(1em + 8px);overflow:hidden;background:var(--faceHeader);border:1px solid rgba(0,0,0,.1);border-radius:4px;transition:top .1s ease,left .1s ease}.mk-autocomplete>ol[data-v-56ea362e]{display:block;margin:0;padding:4px 0;max-height:190px;max-width:500px;overflow:auto;list-style:none}.mk-autocomplete>ol>li[data-v-56ea362e]{display:flex;align-items:center;padding:4px 12px;white-space:nowrap;overflow:hidden;font-size:.9em;color:rgba(0,0,0,.8);cursor:default}.mk-autocomplete>ol>li[data-v-56ea362e],.mk-autocomplete>ol>li *[data-v-56ea362e]{user-select:none}.mk-autocomplete>ol>li *[data-v-56ea362e]{overflow:hidden;text-overflow:ellipsis}.mk-autocomplete>ol>li[data-v-56ea362e]:hover{background:var(--autocompleteItemHoverBg)}.mk-autocomplete>ol>li[data-selected=true][data-v-56ea362e]{background:var(--primary)}.mk-autocomplete>ol>li[data-selected=true][data-v-56ea362e],.mk-autocomplete>ol>li[data-selected=true] *[data-v-56ea362e]{color:#fff!important}.mk-autocomplete>ol>li[data-v-56ea362e]:active{background:var(--primaryDarken10)}.mk-autocomplete>ol>li[data-v-56ea362e]:active,.mk-autocomplete>ol>li:active *[data-v-56ea362e]{color:#fff!important}.mk-autocomplete>.users>li .avatar[data-v-56ea362e]{min-width:28px;min-height:28px;max-width:28px;max-height:28px;margin:0 8px 0 0;border-radius:100%}.mk-autocomplete>.users>li .name[data-v-56ea362e]{margin:0 8px 0 0;color:var(--autocompleteItemText)}.mk-autocomplete>.users>li .username[data-v-56ea362e]{color:var(--autocompleteItemTextSub)}.mk-autocomplete>.hashtags>li .name[data-v-56ea362e]{color:var(--autocompleteItemText)}.mk-autocomplete>.emojis>li .emoji[data-v-56ea362e]{display:inline-block;margin:0 4px 0 0;width:24px}.mk-autocomplete>.emojis>li .emoji>img[data-v-56ea362e]{width:24px;vertical-align:bottom}.mk-autocomplete>.emojis>li .name[data-v-56ea362e]{color:var(--autocompleteItemText)}.mk-autocomplete>.emojis>li .alias[data-v-56ea362e]{margin:0 0 0 8px;color:var(--autocompleteItemTextSub)}"],sourceRoot:""}]),e.exports=s},82852:(e,t,a)=>{"use strict";a.d(t,{Z:()=>o});const o=(e,t)=>{let a=t.parentNode;for(;a;){if(a==e)return!0;a=a.parentNode}return!1}},75476:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var o=a(20144),s=a(30878),i=a(82852),l=a(89851),r=a(99537);const m=s.W.filter((e=>"flags"!==e.category)),n=e=>{let t=Array.from(e).map((e=>e.codePointAt(0).toString(16)));return t.includes("200d")||(t=t.filter((e=>"fe0f"!=e))),t=t.filter((e=>e&&e.length)),t.join("-")},c=m.map((e=>({emoji:e.char,name:e.name,aliasOf:null,url:`${l.P}/${n(e.char)}.svg`})));for(const e of m)if(e.keywords)for(const t of e.keywords)c.push({emoji:e.char,name:t,aliasOf:e.name,url:`${l.P}/${n(e.char)}.svg`});c.sort(((e,t)=>e.name.length-t.name.length));const A=o.default.extend({props:{type:{type:String,required:!0},q:{type:String,required:!0},textarea:{type:Object,required:!0},complete:{type:Function,required:!0},close:{type:Function,required:!0},x:{type:Number,required:!0},y:{type:Number,required:!0}},data:()=>({getStaticImageUrl:r.e,fetching:!0,users:[],hashtags:[],emojis:[],items:[],select:-1,emojilist:s.W,emojiDb:[]}),computed:{useOsDefaultEmojis(){return this.$store.state.device.useOsDefaultEmojis}},updated(){var e;this.x+this.$el.offsetWidth>window.innerWidth?this.$el.style.left=window.innerWidth-this.$el.offsetWidth+"px":this.$el.style.left=this.x+"px",this.y+this.$el.offsetHeight>window.innerHeight?(this.$el.style.top=this.y-this.$el.offsetHeight+"px",this.$el.style.marginTop="0"):(this.$el.style.top=this.y+"px",this.$el.style.marginTop="calc(1em + 8px)"),this.items=(null===(e=this.$refs.suggests)||void 0===e?void 0:e.children)||[]},mounted(){const e=(this.$root.getMetaSync()||{emojis:[]}).emojis||[],t=[];for(const a of e)if(t.push({name:a.name,emoji:`:${a.name}:`,url:a.url,isCustomEmoji:!0}),a.aliases)for(const e of a.aliases)t.push({name:e,aliasOf:a.name,emoji:`:${a.name}:`,url:a.url,isCustomEmoji:!0});t.sort(((e,t)=>e.name.length-t.name.length)),this.emojiDb=t.concat(c),this.textarea.addEventListener("keydown",this.onKeydown);for(const e of Array.from(document.querySelectorAll("body *")))e.addEventListener("mousedown",this.onMousedown);this.$nextTick((()=>{this.exec(),this.$watch("q",(()=>{this.$nextTick((()=>{this.exec()}))}))}))},beforeDestroy(){this.textarea.removeEventListener("keydown",this.onKeydown);for(const e of Array.from(document.querySelectorAll("body *")))e.removeEventListener("mousedown",this.onMousedown)},methods:{exec(){if(this.select=-1,this.$refs.suggests)for(const e of Array.from(this.items))e.removeAttribute("data-selected");if("user"==this.type){const e=`autocomplete:user:${this.q}`,t=sessionStorage.getItem(e);if(t){const e=JSON.parse(t);this.users=e,this.fetching=!1}else this.$root.api("users/search-by-username-and-host",{username:this.q,limit:10,detail:!1}).then((t=>{this.users=t,this.fetching=!1,sessionStorage.setItem(e,JSON.stringify(t))}))}else if("hashtag"==this.type)if(null==this.q||""==this.q)this.hashtags=JSON.parse(localStorage.getItem("hashtags")||"[]"),this.fetching=!1;else{const e=`autocomplete:hashtag:${this.q}`,t=sessionStorage.getItem(e);if(t){const e=JSON.parse(t);this.hashtags=e,this.fetching=!1}else this.$root.api("hashtags/search",{query:this.q,limit:30}).then((t=>{this.hashtags=t,this.fetching=!1,sessionStorage.setItem(e,JSON.stringify(t))}))}else if("emoji"==this.type){if(null==this.q||""==this.q)return void(this.emojis=this.emojiDb.filter((e=>e.isCustomEmoji&&!e.aliasOf)).sort(((e,t)=>{var a=e.name.toUpperCase(),o=t.name.toUpperCase();return a<o?-1:a>o?1:0})));const e=[],t=30;this.emojiDb.some((a=>(!a.name.startsWith(this.q)||a.aliasOf||e.some((e=>e.emoji==a.emoji))||e.push(a),e.length==t))),e.length<t&&this.emojiDb.some((a=>(a.name.startsWith(this.q)&&!e.some((e=>e.emoji==a.emoji))&&e.push(a),e.length==t))),e.length<t&&this.emojiDb.some((a=>(a.name.includes(this.q)&&!e.some((e=>e.emoji==a.emoji))&&e.push(a),e.length==t))),this.emojis=e}},onMousedown(e){(0,i.Z)(this.$el,e.target)||this.$el==e.target||this.close()},onKeydown(e){const t=()=>{e.preventDefault(),e.stopPropagation()};switch(e.which){case 10:case 13:-1!==this.select?(t(),this.items[this.select].click()):this.close();break;case 27:t(),this.close();break;case 38:-1!==this.select?(t(),this.selectPrev()):this.close();break;case 9:case 40:t(),this.selectNext();break;default:e.stopPropagation(),this.textarea.focus()}},selectNext(){++this.select>=this.items.length&&(this.select=0),0===this.items.length&&(this.select=-1),this.applySelect()},selectPrev(){--this.select<0&&(this.select=this.items.length-1),this.applySelect()},applySelect(){for(const e of Array.from(this.items))e.removeAttribute("data-selected");-1!==this.select&&(this.items[this.select].setAttribute("data-selected","true"),this.items[this.select].focus())}}});a(4644);const u=(0,a(51900).Z)(A,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mk-autocomplete",on:{contextmenu:function(e){e.preventDefault()}}},[e.users.length>0?a("ol",{ref:"suggests",staticClass:"users"},e._l(e.users,(function(t){return a("li",{attrs:{tabindex:"-1"},on:{click:function(a){return e.complete(e.type,t)},keydown:e.onKeydown}},[a("img",{staticClass:"avatar",attrs:{src:t.avatarUrl,alt:""}}),a("span",{staticClass:"name"},[a("mk-user-name",{key:t.id,attrs:{user:t}})],1),a("span",{staticClass:"username"},[e._v("@"+e._s(e._f("acct")(t)))])])})),0):e._e(),e.hashtags.length>0?a("ol",{ref:"suggests",staticClass:"hashtags"},e._l(e.hashtags,(function(t){return a("li",{attrs:{tabindex:"-1"},on:{click:function(a){return e.complete(e.type,t)},keydown:e.onKeydown}},[a("span",{staticClass:"name"},[e._v(e._s(t))])])})),0):e._e(),e.emojis.length>0?a("ol",{ref:"suggests",staticClass:"emojis"},e._l(e.emojis,(function(t){return a("li",{attrs:{tabindex:"-1"},on:{click:function(a){return e.complete(e.type,t.emoji)},keydown:e.onKeydown}},[t.isCustomEmoji?a("span",{staticClass:"emoji"},[a("img",{attrs:{src:e.$store.state.device.disableShowingAnimatedImages?e.getStaticImageUrl(t.url):t.url,alt:t.emoji}})]):e.useOsDefaultEmojis?a("span",{staticClass:"emoji"},[e._v(e._s(t.emoji))]):a("span",{staticClass:"emoji"},[a("img",{attrs:{src:t.url,alt:t.emoji}})]),a("span",{staticClass:"name",domProps:{innerHTML:e._s(t.name.replace(e.q,"<b>"+e.q+"</b>"))}}),t.aliasOf?a("span",{staticClass:"alias"},[e._v("("+e._s(t.aliasOf)+")")]):e._e()])})),0):e._e()])}),[],!1,null,"56ea362e",null).exports},4644:(e,t,a)=>{var o=a(66464);"string"==typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);(0,a(45346).Z)("b5a808e2",o,!0,{})}}]);
//# sourceMappingURL=5476.11.37.1-amfe.js.map