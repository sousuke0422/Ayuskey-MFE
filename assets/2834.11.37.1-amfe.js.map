{"version":3,"sources":["webpack://ayuskey-mfe/./src/client/app/common/views/components/messaging.vue?a9f5","webpack://ayuskey-mfe/./src/client/app/common/views/components/messaging.vue?26c9","webpack://ayuskey-mfe/./src/client/app/common/views/components/messaging.vue?bf96","webpack://ayuskey-mfe/./src/client/app/common/views/components/messaging.vue?295d","webpack://ayuskey-mfe/./src/client/app/common/views/components/messaging.vue","webpack://ayuskey-mfe/./src/client/app/common/views/components/messaging.vue?0c41"],"names":["___CSS_LOADER_API_SOURCEMAP_IMPORT___","___CSS_LOADER_EXPORT___","___CSS_LOADER_API_IMPORT___","push","module","id","exports","i18n","props","compact","type","Boolean","default","headerTop","Number","data","fetching","moreFetching","messages","q","result","connection","faUser","this","$root","stream","useSharedConnection","on","onMessage","onRead","api","group","then","userMessages","groupMessages","concat","sort","a","b","Date","createdAt","getTime","dispose","methods","getAcct","message","userId","$store","state","i","recipientId","filter","m","unshift","groupId","ids","found","find","isRead","reads","query","localOnly","limit","detail","users","user","$emit","e","which","preventDefault","stopPropagation","$refs","searchResult","childNodes","focus","list","cancel","search","shiftKey","previousElementSibling","length","nextElementSibling","dialog","local","navigate","groups1","groups2","canceled","title","$t","select","items","map","value","text","name","showCancelButton","navigateGroup","_vm","_h","$createElement","_c","_self","staticClass","attrs","_e","style","top","directives","rawName","expression","domProps","$event","target","composing","onSearchKeydown","ref","_l","indexOf","_k","keyCode","key","onSearchResultKeydown","_v","_s","_f","isMe","recipient","includes","startUser","startGroup","faUsers","content","locals","add"],"mappings":"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","file":"2834.11.37.1-amfe.js","sourcesContent":["// Imports\nvar ___CSS_LOADER_API_SOURCEMAP_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\");\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../../../../node_modules/css-loader/dist/runtime/api.js\");\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".mk-messaging[data-compact][data-v-0a146e72]{font-size:.8em}.mk-messaging[data-compact]>.history>a[data-v-0a146e72]:last-child{border-bottom:none}.mk-messaging[data-compact]>.history>a:not([data-is-me]):not([data-is-read])>div[data-v-0a146e72]{background-image:none;border-left:4px solid #3aa2dc}.mk-messaging[data-compact]>.history>a>div[data-v-0a146e72]{padding:16px}.mk-messaging[data-compact]>.history>a>div>header>.mk-time[data-v-0a146e72]{font-size:1em}.mk-messaging[data-compact]>.history>a>div>.avatar[data-v-0a146e72]{width:42px;height:42px;margin:0 12px 0 0}.mk-messaging>.search[data-v-0a146e72]{display:block;position:-webkit-sticky;position:sticky;top:0;left:0;z-index:1;width:100%;box-shadow:0 0 2px rgba(0,0,0,.2)}.mk-messaging>.search>.form[data-v-0a146e72]{background:rgba(0,0,0,.02)}.mk-messaging>.search>.form>label[data-v-0a146e72]{display:block;position:absolute;top:0;left:8px;z-index:1;height:100%;width:38px;pointer-events:none}.mk-messaging>.search>.form>label>i[data-v-0a146e72]{display:block;position:absolute;top:0;right:0;bottom:0;left:0;width:1em;line-height:48px;margin:auto;color:#555}.mk-messaging>.search>.form>input[data-v-0a146e72]{margin:0;padding:0 0 0 42px;width:100%;font-size:1em;line-height:48px;color:var(--faceText);outline:none;background:transparent;border:none;border-radius:5px;box-shadow:none}.mk-messaging>.search>.result[data-v-0a146e72]{display:block;top:0;left:0;z-index:2;width:100%;margin:0;padding:0;background:#fff}.mk-messaging>.search>.result>.users[data-v-0a146e72]{margin:0;padding:0;list-style:none}.mk-messaging>.search>.result>.users>li[data-v-0a146e72]{display:inline-block;z-index:1;width:100%;padding:8px 32px;vertical-align:top;white-space:nowrap;overflow:hidden;color:rgba(0,0,0,.8);text-decoration:none;transition:none;cursor:pointer}.mk-messaging>.search>.result>.users>li[data-v-0a146e72]:focus,.mk-messaging>.search>.result>.users>li[data-v-0a146e72]:hover{color:#fff;background:var(--primary)}.mk-messaging>.search>.result>.users>li:focus .name[data-v-0a146e72],.mk-messaging>.search>.result>.users>li:focus .username[data-v-0a146e72],.mk-messaging>.search>.result>.users>li:hover .name[data-v-0a146e72],.mk-messaging>.search>.result>.users>li:hover .username[data-v-0a146e72]{color:#fff}.mk-messaging>.search>.result>.users>li[data-v-0a146e72]:active{color:#fff;background:var(--primaryDarken10)}.mk-messaging>.search>.result>.users>li:active .name[data-v-0a146e72],.mk-messaging>.search>.result>.users>li:active .username[data-v-0a146e72]{color:#fff}.mk-messaging>.search>.result>.users>li .avatar[data-v-0a146e72]{vertical-align:middle;min-width:32px;min-height:32px;max-width:32px;max-height:32px;margin:0 8px 0 0;border-radius:6px}.mk-messaging>.search>.result>.users>li .name[data-v-0a146e72]{margin:0 8px 0 0;font-weight:400;color:rgba(0,0,0,.8)}.mk-messaging>.search>.result>.users>li .username[data-v-0a146e72]{font-weight:400;color:rgba(0,0,0,.3)}.mk-messaging>.history>a[data-v-0a146e72]{display:block;text-decoration:none;background:var(--face);border-bottom:1px solid var(--faceDivider)}.mk-messaging>.history>a *[data-v-0a146e72]{pointer-events:none;user-select:none}.mk-messaging>.history>a[data-v-0a146e72]:hover{box-shadow:inset 0 0 0 100px rgba(0,0,0,.05)}.mk-messaging>.history>a:hover .avatar[data-v-0a146e72]{filter:saturate(200%)}.mk-messaging>.history>a[data-v-0a146e72]:active{box-shadow:inset 0 0 0 100px rgba(0,0,0,.1)}.mk-messaging>.history>a[data-is-me][data-v-0a146e72],.mk-messaging>.history>a[data-is-read][data-v-0a146e72]{opacity:.8}.mk-messaging>.history>a:not([data-is-me]):not([data-is-read])>div[data-v-0a146e72]{background-image:url(/assets/unread.svg);background-repeat:no-repeat;background-position:0}.mk-messaging>.history>a[data-v-0a146e72]:after{content:\\\"\\\";display:block;clear:both}.mk-messaging>.history>a>div[data-v-0a146e72]{max-width:500px;margin:0 auto;padding:20px 30px}.mk-messaging>.history>a>div[data-v-0a146e72]:after{content:\\\"\\\";display:block;clear:both}.mk-messaging>.history>a>div>header[data-v-0a146e72]{display:flex;align-items:center;margin-bottom:2px;white-space:nowrap;overflow:hidden}.mk-messaging>.history>a>div>header>.name[data-v-0a146e72]{margin:0;padding:0;overflow:hidden;text-overflow:ellipsis;font-size:1em;color:var(--noteHeaderName);font-weight:700;transition:all .1s ease}.mk-messaging>.history>a>div>header>.username[data-v-0a146e72]{margin:0 8px;color:var(--noteHeaderAcct)}.mk-messaging>.history>a>div>header>.mk-time[data-v-0a146e72]{margin:0 0 0 auto;color:var(--noteHeaderInfo);font-size:80%}.mk-messaging>.history>a>div>.avatar[data-v-0a146e72]{float:left;width:54px;height:54px;margin:0 16px 0 0;border-radius:8px;transition:all .1s ease}.mk-messaging>.history>a>div>.body>.text[data-v-0a146e72]{display:block;margin:0;padding:0;overflow:hidden;overflow-wrap:break-word;font-size:1.1em;color:var(--faceText)}.mk-messaging>.history>a>div>.body>.text .me[data-v-0a146e72]{opacity:.7}.mk-messaging>.history>a>div>.body>.image[data-v-0a146e72]{display:block;max-width:100%;max-height:512px}.mk-messaging>.no-history[data-v-0a146e72]{margin:0;padding:2em 1em;text-align:center;color:#999;font-weight:500}.mk-messaging>.fetching[data-v-0a146e72]{margin:0;padding:16px;text-align:center;color:var(--text)}.mk-messaging>.fetching>[data-icon][data-v-0a146e72]{margin-right:4px}@media (max-width:400px){.mk-messaging>.search>.result>.users>li[data-v-0a146e72]{padding:8px 16px}.mk-messaging>.history>a:not([data-is-me]):not([data-is-read])>div[data-v-0a146e72]{background-image:none;border-left:4px solid #3aa2dc}.mk-messaging>.history>a>div[data-v-0a146e72]{padding:16px;font-size:14px}.mk-messaging>.history>a>div>.avatar[data-v-0a146e72]{margin:0 12px 0 0}}\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/client/app/common/views/components/messaging.vue\"],\"names\":[],\"mappings\":\"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\",\"sourcesContent\":[\".mk-messaging[data-compact][data-v-0a146e72]{font-size:.8em}.mk-messaging[data-compact]>.history>a[data-v-0a146e72]:last-child{border-bottom:none}.mk-messaging[data-compact]>.history>a:not([data-is-me]):not([data-is-read])>div[data-v-0a146e72]{background-image:none;border-left:4px solid #3aa2dc}.mk-messaging[data-compact]>.history>a>div[data-v-0a146e72]{padding:16px}.mk-messaging[data-compact]>.history>a>div>header>.mk-time[data-v-0a146e72]{font-size:1em}.mk-messaging[data-compact]>.history>a>div>.avatar[data-v-0a146e72]{width:42px;height:42px;margin:0 12px 0 0}.mk-messaging>.search[data-v-0a146e72]{display:block;position:-webkit-sticky;position:sticky;top:0;left:0;z-index:1;width:100%;box-shadow:0 0 2px rgba(0,0,0,.2)}.mk-messaging>.search>.form[data-v-0a146e72]{background:rgba(0,0,0,.02)}.mk-messaging>.search>.form>label[data-v-0a146e72]{display:block;position:absolute;top:0;left:8px;z-index:1;height:100%;width:38px;pointer-events:none}.mk-messaging>.search>.form>label>i[data-v-0a146e72]{display:block;position:absolute;top:0;right:0;bottom:0;left:0;width:1em;line-height:48px;margin:auto;color:#555}.mk-messaging>.search>.form>input[data-v-0a146e72]{margin:0;padding:0 0 0 42px;width:100%;font-size:1em;line-height:48px;color:var(--faceText);outline:none;background:transparent;border:none;border-radius:5px;box-shadow:none}.mk-messaging>.search>.result[data-v-0a146e72]{display:block;top:0;left:0;z-index:2;width:100%;margin:0;padding:0;background:#fff}.mk-messaging>.search>.result>.users[data-v-0a146e72]{margin:0;padding:0;list-style:none}.mk-messaging>.search>.result>.users>li[data-v-0a146e72]{display:inline-block;z-index:1;width:100%;padding:8px 32px;vertical-align:top;white-space:nowrap;overflow:hidden;color:rgba(0,0,0,.8);text-decoration:none;transition:none;cursor:pointer}.mk-messaging>.search>.result>.users>li[data-v-0a146e72]:focus,.mk-messaging>.search>.result>.users>li[data-v-0a146e72]:hover{color:#fff;background:var(--primary)}.mk-messaging>.search>.result>.users>li:focus .name[data-v-0a146e72],.mk-messaging>.search>.result>.users>li:focus .username[data-v-0a146e72],.mk-messaging>.search>.result>.users>li:hover .name[data-v-0a146e72],.mk-messaging>.search>.result>.users>li:hover .username[data-v-0a146e72]{color:#fff}.mk-messaging>.search>.result>.users>li[data-v-0a146e72]:active{color:#fff;background:var(--primaryDarken10)}.mk-messaging>.search>.result>.users>li:active .name[data-v-0a146e72],.mk-messaging>.search>.result>.users>li:active .username[data-v-0a146e72]{color:#fff}.mk-messaging>.search>.result>.users>li .avatar[data-v-0a146e72]{vertical-align:middle;min-width:32px;min-height:32px;max-width:32px;max-height:32px;margin:0 8px 0 0;border-radius:6px}.mk-messaging>.search>.result>.users>li .name[data-v-0a146e72]{margin:0 8px 0 0;font-weight:400;color:rgba(0,0,0,.8)}.mk-messaging>.search>.result>.users>li .username[data-v-0a146e72]{font-weight:400;color:rgba(0,0,0,.3)}.mk-messaging>.history>a[data-v-0a146e72]{display:block;text-decoration:none;background:var(--face);border-bottom:1px solid var(--faceDivider)}.mk-messaging>.history>a *[data-v-0a146e72]{pointer-events:none;user-select:none}.mk-messaging>.history>a[data-v-0a146e72]:hover{box-shadow:inset 0 0 0 100px rgba(0,0,0,.05)}.mk-messaging>.history>a:hover .avatar[data-v-0a146e72]{filter:saturate(200%)}.mk-messaging>.history>a[data-v-0a146e72]:active{box-shadow:inset 0 0 0 100px rgba(0,0,0,.1)}.mk-messaging>.history>a[data-is-me][data-v-0a146e72],.mk-messaging>.history>a[data-is-read][data-v-0a146e72]{opacity:.8}.mk-messaging>.history>a:not([data-is-me]):not([data-is-read])>div[data-v-0a146e72]{background-image:url(/assets/unread.svg);background-repeat:no-repeat;background-position:0}.mk-messaging>.history>a[data-v-0a146e72]:after{content:\\\"\\\";display:block;clear:both}.mk-messaging>.history>a>div[data-v-0a146e72]{max-width:500px;margin:0 auto;padding:20px 30px}.mk-messaging>.history>a>div[data-v-0a146e72]:after{content:\\\"\\\";display:block;clear:both}.mk-messaging>.history>a>div>header[data-v-0a146e72]{display:flex;align-items:center;margin-bottom:2px;white-space:nowrap;overflow:hidden}.mk-messaging>.history>a>div>header>.name[data-v-0a146e72]{margin:0;padding:0;overflow:hidden;text-overflow:ellipsis;font-size:1em;color:var(--noteHeaderName);font-weight:700;transition:all .1s ease}.mk-messaging>.history>a>div>header>.username[data-v-0a146e72]{margin:0 8px;color:var(--noteHeaderAcct)}.mk-messaging>.history>a>div>header>.mk-time[data-v-0a146e72]{margin:0 0 0 auto;color:var(--noteHeaderInfo);font-size:80%}.mk-messaging>.history>a>div>.avatar[data-v-0a146e72]{float:left;width:54px;height:54px;margin:0 16px 0 0;border-radius:8px;transition:all .1s ease}.mk-messaging>.history>a>div>.body>.text[data-v-0a146e72]{display:block;margin:0;padding:0;overflow:hidden;overflow-wrap:break-word;font-size:1.1em;color:var(--faceText)}.mk-messaging>.history>a>div>.body>.text .me[data-v-0a146e72]{opacity:.7}.mk-messaging>.history>a>div>.body>.image[data-v-0a146e72]{display:block;max-width:100%;max-height:512px}.mk-messaging>.no-history[data-v-0a146e72]{margin:0;padding:2em 1em;text-align:center;color:#999;font-weight:500}.mk-messaging>.fetching[data-v-0a146e72]{margin:0;padding:16px;text-align:center;color:var(--text)}.mk-messaging>.fetching>[data-icon][data-v-0a146e72]{margin-right:4px}@media (max-width:400px){.mk-messaging>.search>.result>.users>li[data-v-0a146e72]{padding:8px 16px}.mk-messaging>.history>a:not([data-is-me]):not([data-is-read])>div[data-v-0a146e72]{background-image:none;border-left:4px solid #3aa2dc}.mk-messaging>.history>a>div[data-v-0a146e72]{padding:16px;font-size:14px}.mk-messaging>.history>a>div>.avatar[data-v-0a146e72]{margin:0 12px 0 0}}\"],\"sourceRoot\":\"\"}]);\n// Exports\nmodule.exports = ___CSS_LOADER_EXPORT___;\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"mk-messaging\",attrs:{\"data-compact\":_vm.compact}},[(!_vm.compact)?_c('div',{staticClass:\"search\",style:({ top: _vm.headerTop + 'px' })},[_c('div',{staticClass:\"form\"},[_c('label',{attrs:{\"for\":\"search-input\"}},[_c('i',[_c('fa',{attrs:{\"icon\":\"search\"}})],1)]),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.q),expression:\"q\"}],attrs:{\"type\":\"search\",\"placeholder\":_vm.$t('search-user')},domProps:{\"value\":(_vm.q)},on:{\"input\":[function($event){if($event.target.composing){ return; }_vm.q=$event.target.value},_vm.search],\"keydown\":_vm.onSearchKeydown}})]),_c('div',{staticClass:\"result\"},[(_vm.result.length > 0)?_c('ol',{ref:\"searchResult\",staticClass:\"users\"},_vm._l((_vm.result),function(user,i){return _c('li',{attrs:{\"tabindex\":\"-1\"},on:{\"keydown\":[function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.navigate(user)},function($event){return _vm.onSearchResultKeydown(i)}],\"click\":function($event){return _vm.navigate(user)}}},[_c('mk-avatar',{key:user.id,staticClass:\"avatar\",attrs:{\"user\":user}}),_c('span',{staticClass:\"name\"},[_c('mk-user-name',{key:user.id,attrs:{\"user\":user}})],1),_c('span',{staticClass:\"username\"},[_vm._v(\"@\"+_vm._s(_vm._f(\"acct\")(user)))])],1)}),0):_vm._e()])]):_vm._e(),(_vm.messages.length > 0)?_c('div',{staticClass:\"history\"},_vm._l((_vm.messages),function(message){return _c('a',{key:message.id,staticClass:\"user\",attrs:{\"href\":message.groupId ? (\"/i/messaging/group/\" + (message.groupId)) : (\"/i/messaging/\" + (_vm.getAcct(_vm.isMe(message) ? message.recipient : message.user))),\"data-is-me\":_vm.isMe(message),\"data-is-read\":message.groupId ? message.reads.includes(_vm.$store.state.i.id) : message.isRead},on:{\"click\":function($event){$event.preventDefault();message.groupId ? _vm.navigateGroup(message.group) : _vm.navigate(_vm.isMe(message) ? message.recipient : message.user)}}},[_c('div',[_c('mk-avatar',{staticClass:\"avatar\",attrs:{\"user\":message.groupId ? message.user : _vm.isMe(message) ? message.recipient : message.user}}),(message.groupId)?_c('header',[_c('span',{staticClass:\"name\"},[_vm._v(_vm._s(message.group.name))]),_c('mk-time',{attrs:{\"time\":message.createdAt}})],1):_c('header',[_c('span',{staticClass:\"name\"},[_c('mk-user-name',{attrs:{\"user\":_vm.isMe(message) ? message.recipient : message.user}})],1),_c('span',{staticClass:\"username\"},[_vm._v(\"@\"+_vm._s(_vm._f(\"acct\")(_vm.isMe(message) ? message.recipient : message.user)))]),_c('mk-time',{attrs:{\"time\":message.createdAt}})],1),_c('div',{staticClass:\"body\"},[_c('p',{staticClass:\"text\"},[(_vm.isMe(message))?_c('span',{staticClass:\"me\"},[_vm._v(_vm._s(_vm.$t('you'))+\":\")]):_vm._e(),_vm._v(_vm._s(message.text))])])],1)])}),0):_vm._e(),(!_vm.fetching && _vm.messages.length == 0)?_c('p',{staticClass:\"no-history\"},[_vm._v(_vm._s(_vm.$t('no-history')))]):_vm._e(),(_vm.fetching)?_c('p',{staticClass:\"fetching\"},[_c('fa',{attrs:{\"icon\":\"spinner\",\"pulse\":\"\",\"fixed-width\":\"\"}}),_vm._v(_vm._s(_vm.$t('@.loading'))),_c('mk-ellipsis')],1):_vm._e(),_c('ui-margin',[_c('ui-button',{on:{\"click\":function($event){return _vm.startUser()}}},[_c('fa',{attrs:{\"icon\":_vm.faUser}}),_vm._v(\" \"+_vm._s(_vm.$t('start-with-user')))],1),_c('ui-button',{on:{\"click\":function($event){return _vm.startGroup()}}},[_c('fa',{attrs:{\"icon\":_vm.faUsers}}),_vm._v(\" \"+_vm._s(_vm.$t('start-with-group')))],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import Vue from 'vue';\nimport { faUser, faUsers } from '@fortawesome/free-solid-svg-icons';\nimport i18n from '../../../i18n';\nimport getAcct from '../../../../../misc/acct/render';\nexport default Vue.extend({\n    i18n: i18n('common/views/components/messaging.vue'),\n    props: {\n        compact: {\n            type: Boolean,\n            default: false\n        },\n        headerTop: {\n            type: Number,\n            default: 0\n        }\n    },\n    data() {\n        return {\n            fetching: true,\n            moreFetching: false,\n            messages: [],\n            q: null,\n            result: [],\n            connection: null,\n            faUser, faUsers,\n        };\n    },\n    mounted() {\n        this.connection = this.$root.stream.useSharedConnection('messagingIndex');\n        this.connection.on('message', this.onMessage);\n        this.connection.on('read', this.onRead);\n        this.$root.api('messaging/history', { group: false }).then(userMessages => {\n            this.$root.api('messaging/history', { group: true }).then(groupMessages => {\n                const messages = userMessages.concat(groupMessages);\n                messages.sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime());\n                this.messages = messages;\n                this.fetching = false;\n            });\n        });\n    },\n    beforeDestroy() {\n        this.connection.dispose();\n    },\n    methods: {\n        getAcct,\n        isMe(message) {\n            return message.userId == this.$store.state.i.id;\n        },\n        onMessage(message) {\n            if (message.recipientId) {\n                this.messages = this.messages.filter(m => !((m.recipientId == message.recipientId && m.userId == message.userId) ||\n                    (m.recipientId == message.userId && m.userId == message.recipientId)));\n                this.messages.unshift(message);\n            }\n            else if (message.groupId) {\n                this.messages = this.messages.filter(m => m.groupId !== message.groupId);\n                this.messages.unshift(message);\n            }\n        },\n        onRead(ids) {\n            for (const id of ids) {\n                const found = this.messages.find(m => m.id == id);\n                if (found) {\n                    if (found.recipientId) {\n                        found.isRead = true;\n                    }\n                    else if (found.groupId) {\n                        found.reads.push(this.$store.state.i.id);\n                    }\n                }\n            }\n        },\n        search() {\n            if (this.q == '') {\n                this.result = [];\n                return;\n            }\n            this.$root.api('users/search', {\n                query: this.q,\n                localOnly: false,\n                limit: 10,\n                detail: false\n            }).then(users => {\n                this.result = users.filter(user => user.id != this.$store.state.i.id);\n            });\n        },\n        navigate(user) {\n            this.$emit('navigate', user);\n        },\n        navigateGroup(group) {\n            this.$emit('navigateGroup', group);\n        },\n        onSearchKeydown(e) {\n            switch (e.which) {\n                case 9: // [TAB]\n                case 40: // [↓]\n                    e.preventDefault();\n                    e.stopPropagation();\n                    this.$refs.searchResult.childNodes[0].focus();\n                    break;\n            }\n        },\n        onSearchResultKeydown(i, e) {\n            const list = this.$refs.searchResult;\n            const cancel = () => {\n                e.preventDefault();\n                e.stopPropagation();\n            };\n            switch (true) {\n                case e.which == 27: // [ESC]\n                    cancel();\n                    this.$refs.search.focus();\n                    break;\n                case e.which == 9 && e.shiftKey: // [TAB] + [Shift]\n                case e.which == 38: // [↑]\n                    cancel();\n                    (list.childNodes[i].previousElementSibling || list.childNodes[this.result.length - 1]).focus();\n                    break;\n                case e.which == 9: // [TAB]\n                case e.which == 40: // [↓]\n                    cancel();\n                    (list.childNodes[i].nextElementSibling || list.childNodes[0]).focus();\n                    break;\n            }\n        },\n        async startUser() {\n            const { result: user } = await this.$root.dialog({\n                user: {\n                    local: true\n                }\n            });\n            if (user == null)\n                return;\n            this.navigate(user);\n        },\n        async startGroup() {\n            const groups1 = await this.$root.api('users/groups/owned');\n            const groups2 = await this.$root.api('users/groups/joined');\n            const { canceled, result: group } = await this.$root.dialog({\n                type: null,\n                title: this.$t('select-group'),\n                select: {\n                    items: groups1.concat(groups2).map(group => ({\n                        value: group, text: group.name\n                    }))\n                },\n                showCancelButton: true\n            });\n            if (canceled)\n                return;\n            this.navigateGroup(group);\n        }\n    }\n});\n","import mod from \"-!../../../../../../node_modules/ts-loader/index.js??clonedRuleSet-7[0].rules[0].use[0]!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../node_modules/vue-svg-inline-loader/src/index.js!./messaging.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../../../../node_modules/ts-loader/index.js??clonedRuleSet-7[0].rules[0].use[0]!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../node_modules/vue-svg-inline-loader/src/index.js!./messaging.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./messaging.vue?vue&type=template&id=0a146e72&scoped=true&\"\nimport script from \"./messaging.vue?vue&type=script&lang=ts&\"\nexport * from \"./messaging.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./messaging.vue?vue&type=style&index=0&id=0a146e72&lang=stylus&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0a146e72\",\n  null\n  \n)\n\nexport default component.exports","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-3[0].rules[0].use[1]!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/postcss-loader/src/index.js??clonedRuleSet-3[0].rules[0].use[2]!../../../../../../node_modules/stylus-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../node_modules/vue-svg-inline-loader/src/index.js!./messaging.vue?vue&type=style&index=0&id=0a146e72&lang=stylus&scoped=true&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"61a68672\", content, true, {});"],"sourceRoot":""}