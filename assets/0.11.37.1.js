(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{502:function(e,t,a){"use strict";var n=a(0),i=a(5),o=a(10),s=a(2),r=n.a.extend({i18n:Object(s.a)("pages"),props:{expanded:{type:Boolean,default:!0},removable:{type:Boolean,default:!0},draggable:{type:Boolean,default:!1},error:{required:!1,default:null},warn:{required:!1,default:null}},data(){return{showBody:this.expanded,faTrashAlt:o.F,faBars:i.q}},methods:{toggleContent(e){this.showBody=e,this.$emit("toggle",e)},remove(){this.$emit("remove")}}}),l=(a(708),a(1)),u=Object(l.a)(r,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"cpjygsrt",class:{error:null!=e.error,warn:null!=e.warn}},[a("header",[a("div",{staticClass:"title"},[e._t("header")],2),a("div",{staticClass:"buttons"},[e._t("func"),e.removable?a("button",{on:{click:function(t){return e.remove()}}},[a("fa",{attrs:{icon:e.faTrashAlt}})],1):e._e(),e.draggable?a("button",{staticClass:"drag-handle"},[a("fa",{attrs:{icon:e.faBars}})],1):e._e(),a("button",{on:{click:function(t){return e.toggleContent(!e.showBody)}}},[e.showBody?[a("fa",{attrs:{icon:"angle-up"}})]:[a("fa",{attrs:{icon:"angle-down"}})]],2)],2)]),null!=e.error?a("p",{directives:[{name:"show",rawName:"v-show",value:e.showBody,expression:"showBody"}],staticClass:"error"},[e._v(e._s(e.$t("script.typeError",{slot:e.error.arg+1,expect:e.$t("script.types."+e.error.expect),actual:e.$t("script.types."+e.error.actual)})))]):e._e(),null!=e.warn?a("p",{directives:[{name:"show",rawName:"v-show",value:e.showBody,expression:"showBody"}],staticClass:"warn"},[e._v(e._s(e.$t("script.thereIsEmptySlot",{slot:e.warn.slot+1})))]):e._e(),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showBody,expression:"showBody"}]},[e._t("default")],2)])}),[],!1,null,"60ccf125",null);t.a=u.exports},505:function(e,t,a){var n=a(513);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a(4).default)("194b0d7c",n,!0,{})},511:function(e,t,a){"use strict";a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return r})),a.d(t,"d",(function(){return l})),a.d(t,"b",(function(){return u})),a.d(t,"e",(function(){return c}));var n=a(5),i=a(10);const o={if:{in:["boolean",0,0],out:0,category:"flow",icon:n.yc},for:{in:["number","function"],out:null,category:"flow",icon:n.pc},not:{in:["boolean"],out:"boolean",category:"logical",icon:i.m},or:{in:["boolean","boolean"],out:"boolean",category:"logical",icon:i.m},and:{in:["boolean","boolean"],out:"boolean",category:"logical",icon:i.m},add:{in:["number","number"],out:"number",category:"operation",icon:n.ic},subtract:{in:["number","number"],out:"number",category:"operation",icon:n.Xb},multiply:{in:["number","number"],out:"number",category:"operation",icon:n.Mc},divide:{in:["number","number"],out:"number",category:"operation",icon:n.T},mod:{in:["number","number"],out:"number",category:"operation",icon:n.T},round:{in:["number"],out:"number",category:"operation",icon:n.x},eq:{in:[0,0],out:"boolean",category:"comparison",icon:n.bb},notEq:{in:[0,0],out:"boolean",category:"comparison",icon:n.dc},gt:{in:["number","number"],out:"boolean",category:"comparison",icon:n.xb},lt:{in:["number","number"],out:"boolean",category:"comparison",icon:n.Lb},gtEq:{in:["number","number"],out:"boolean",category:"comparison",icon:n.yb},ltEq:{in:["number","number"],out:"boolean",category:"comparison",icon:n.Mb},strLen:{in:["string"],out:"number",category:"text",icon:n.oc},strPick:{in:["string","number"],out:"string",category:"text",icon:n.oc},strReplace:{in:["string","string","string"],out:"string",category:"text",icon:n.oc},strReverse:{in:["string"],out:"string",category:"text",icon:n.oc},join:{in:["stringArray","string"],out:"string",category:"text",icon:n.oc},stringToNumber:{in:["string"],out:"number",category:"convert",icon:n.cb},numberToString:{in:["number"],out:"string",category:"convert",icon:n.cb},splitStrByLine:{in:["string"],out:"stringArray",category:"convert",icon:n.cb},pick:{in:[null,"number"],out:null,category:"list",icon:n.Gb},listLen:{in:[null],out:"number",category:"list",icon:n.Gb},rannum:{in:["number","number"],out:"number",category:"random",icon:n.S},dailyRannum:{in:["number","number"],out:"number",category:"random",icon:n.S},seedRannum:{in:[null,"number","number"],out:"number",category:"random",icon:n.S},random:{in:["number"],out:"boolean",category:"random",icon:n.S},dailyRandom:{in:["number"],out:"boolean",category:"random",icon:n.S},seedRandom:{in:[null,"number"],out:"boolean",category:"random",icon:n.S},randomPick:{in:[0],out:0,category:"random",icon:n.S},dailyRandomPick:{in:[0],out:0,category:"random",icon:n.S},seedRandomPick:{in:[null,0],out:0,category:"random",icon:n.S},DRPWPM:{in:["stringArray"],out:"string",category:"random",icon:n.S}},s={text:{out:"string",category:"value",icon:n.oc},multiLineText:{out:"string",category:"value",icon:n.a},textList:{out:"stringArray",category:"value",icon:n.Ob},number:{out:"number",category:"value",icon:n.Cc},ref:{out:null,category:"value",icon:n.Rb},fn:{out:"function",category:"value",icon:n.Ec}},r=[...Object.entries(s).map(([e,t])=>({type:e,out:t.out,category:t.category,icon:t.icon})),...Object.entries(o).map(([e,t])=>({type:e,out:t.out,category:t.category,icon:t.icon}))];function l(e){return"fn"===e.type}const u={AI:"string",URL:"string",VERSION:"string",LOGIN:"boolean",NAME:"string",USERNAME:"string",USERID:"string",NOTES_COUNT:"number",FOLLOWERS_COUNT:"number",FOLLOWING_COUNT:"number",IS_CAT:"boolean",MY_NOTES_COUNT:"number",MY_FOLLOWERS_COUNT:"number",MY_FOLLOWING_COUNT:"number",SEED:null,YMD:"string",NULL:null};function c(e){return null===e.type||!!s[e.type]}},512:function(e,t,a){"use strict";var n=a(505);a.n(n).a},513:function(e,t,a){(t=a(3)(!1)).push([e.i,".zdjebgpv[data-v-cd0797c6]{display:flex}.zdjebgpv>.icon[data-v-cd0797c6],.zdjebgpv>img[data-v-cd0797c6]{pointer-events:none}.zdjebgpv>.icon-sub[data-v-cd0797c6]{position:absolute;width:30%;height:auto;margin:0;right:4%;bottom:4%}.zdjebgpv>*[data-v-cd0797c6]{margin:auto}.zdjebgpv:not(.detail)>img[data-v-cd0797c6]{height:100%;width:100%;object-fit:cover}.zdjebgpv:not(.detail)>.icon[data-v-cd0797c6]{height:65%;width:65%}.zdjebgpv:not(.detail)>audio[data-v-cd0797c6],.zdjebgpv:not(.detail)>video[data-v-cd0797c6]{width:100%}.zdjebgpv.detail>.icon[data-v-cd0797c6]{height:100px;width:100px;margin:16px}.zdjebgpv.detail[data-v-cd0797c6]>:not(.icon){max-height:300px;max-width:100%;height:100%;object-fit:contain}",""]),e.exports=t},514:function(e,t,a){"use strict";var n=a(0),i=a(9),o=a(5),s=n.a.extend({props:{file:{type:Object,required:!0},fit:{type:String,required:!1,default:"cover"},detail:{type:Boolean,required:!1,default:!1}},data:()=>({isContextmenuShowing:!1,isDragging:!1,faFile:o.hb,faFileAlt:o.ib,faFileImage:o.lb,faMusic:o.bc,faFileVideo:o.ob,faFileCsv:o.kb,faFilePdf:o.nb,faFileArchive:o.jb,faFilm:o.pb}),computed:{is(){return this.file.type.startsWith("image/")?"image":this.file.type.startsWith("video/")?"video":"audio/midi"===this.file.type?"midi":this.file.type.startsWith("audio/")?"audio":this.file.type.endsWith("/csv")?"csv":this.file.type.endsWith("/pdf")?"pdf":this.file.type.startsWith("text/")?"textfile":["application/zip","application/x-cpio","application/x-bzip","application/x-bzip2","application/java-archive","application/x-rar-compressed","application/x-tar","application/gzip","application/x-7z-compressed"].some(e=>e===this.file.type)?"archive":"unknown"},isThumbnailAvailable(){return!!this.file.thumbnailUrl&&("image"===this.is||"video"===this.is)},background(){return this.file.properties.avgColor||"transparent"}},mounted(){const e=this.$refs.volumectrl;e&&(e.volume=this.$store.state.device.mediaVolume)},methods:{onThumbnailLoaded(){this.file.properties.avgColor&&Object(i.a)({targets:this.$refs.thumbnail,backgroundColor:"transparent",duration:100,easing:"linear"})},volumechange(){const e=this.$refs.volumectrl;this.$store.commit("device/set",{key:"mediaVolume",value:e.volume})}}}),r=(a(512),a(1)),l=Object(r.a)(s,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"thumbnail",staticClass:"zdjebgpv",class:{detail:e.detail},style:"background-color: "+e.background},[e.detail&&"image"===e.is?a("img",{attrs:{src:e.file.url,alt:e.file.name,title:e.file.name},on:{load:e.onThumbnailLoaded}}):e.detail&&"video"===e.is?a("video",{ref:"volumectrl",attrs:{src:e.file.url,preload:"metadata",controls:""}}):e.isThumbnailAvailable?a("img",{style:"object-fit: "+e.fit,attrs:{src:e.file.thumbnailUrl,alt:""},on:{load:e.onThumbnailLoaded}}):"image"===e.is?a("fa",{staticClass:"icon",attrs:{icon:e.faFileImage}}):"video"===e.is?a("fa",{staticClass:"icon",attrs:{icon:e.faFileVideo}}):e.detail&&"audio"===e.is?a("audio",{ref:"volumectrl",attrs:{src:e.file.url,preload:"metadata",controls:""}}):"audio"===e.is||"midi"===e.is?a("fa",{staticClass:"icon",attrs:{icon:e.faMusic}}):"csv"===e.is?a("fa",{staticClass:"icon",attrs:{icon:e.faFileCsv}}):"pdf"===e.is?a("fa",{staticClass:"icon",attrs:{icon:e.faFilePdf}}):"textfile"===e.is?a("fa",{staticClass:"icon",attrs:{icon:e.faFileAlt}}):"archive"===e.is?a("fa",{staticClass:"icon",attrs:{icon:e.faFileArchive}}):a("fa",{staticClass:"icon",attrs:{icon:e.faFile}}),!e.detail&&e.isThumbnailAvailable&&"video"===e.is?a("fa",{staticClass:"icon-sub",attrs:{icon:e.faFilm}}):e._e()],1)}),[],!1,null,"cd0797c6",null);t.a=l.exports},547:function(e,t,a){"use strict";function n(e){const t=[],a=e=>{for(const n of e)"textInput"===n.type?t.push({name:n.name,type:"string",value:n.default||""}):"textareaInput"===n.type?t.push({name:n.name,type:"string",value:n.default||""}):"numberInput"===n.type?t.push({name:n.name,type:"number",value:n.default||0}):"switch"===n.type?t.push({name:n.name,type:"boolean",value:n.default||!1}):"counter"===n.type?t.push({name:n.name,type:"number",value:0}):"radioButton"===n.type?t.push({name:n.name,type:"string",value:n.default||""}):n.children&&a(n.children)};return a(e),t}a.d(t,"a",(function(){return n}))},559:function(e,t,a){var n=a(709);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a(4).default)("4231b8e1",n,!0,{})},560:function(e,t,a){var n=a(711);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a(4).default)("1e0d5752",n,!0,{})},561:function(e,t,a){var n=a(713);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a(4).default)("2bc793fe",n,!0,{})},562:function(e,t,a){var n=a(715);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a(4).default)("ad15cc7e",n,!0,{})},563:function(e,t,a){var n=a(717);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a(4).default)("ae6e9a20",n,!0,{})},564:function(e,t,a){var n=a(719);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a(4).default)("81a568e4",n,!0,{})},565:function(e,t,a){var n=a(721);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a(4).default)("cf3f11fa",n,!0,{})},566:function(e,t,a){var n=a(723);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a(4).default)("845a3a40",n,!0,{})},567:function(e,t,a){var n=a(725);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a(4).default)("73d5884a",n,!0,{})},568:function(e,t,a){var n=a(727);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a(4).default)("27d12e9d",n,!0,{})},604:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a(189),o=a(14),s=a(5),r=a(10),l=a(2),u=a(502),c=n.a.extend({i18n:Object(l.a)("pages"),components:{XContainer:u.a},inject:["getPageBlockList"],props:{value:{required:!0},aiScript:{required:!0}},data:()=>({faStickyNote:r.C,faPlus:s.ic,faPencilAlt:s.gc}),beforeCreate(){this.$options.components.XBlocks=a(604).default},created(){null==this.value.title&&n.a.set(this.value,"title",null),null==this.value.children&&n.a.set(this.value,"children",[])},mounted(){null==this.value.title&&this.rename()},methods:{async rename(){const{canceled:e,result:t}=await this.$root.dialog({title:"Enter title",input:{type:"text",default:this.value.title},showCancelButton:!0});e||(this.value.title=t)},async add(){const{canceled:e,result:t}=await this.$root.dialog({type:null,title:this.$t("choose-block"),select:{groupedItems:this.getPageBlockList()},showCancelButton:!0});if(e)return;const a=Object(o.v4)();this.value.children.push({id:a,type:t})}}}),p=(a(712),a(1)),d=Object(p.a)(c,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("x-container",{attrs:{draggable:!0},on:{remove:function(){return e.$emit("remove")}},scopedSlots:e._u([{key:"header",fn:function(){return[a("fa",{attrs:{icon:e.faStickyNote}}),e._v(" "+e._s(e.value.title))]},proxy:!0},{key:"func",fn:function(){return[a("button",{on:{click:function(t){return e.rename()}}},[a("fa",{attrs:{icon:e.faPencilAlt}})],1),a("button",{on:{click:function(t){return e.add()}}},[a("fa",{attrs:{icon:e.faPlus}})],1)]},proxy:!0}])},[a("section",{staticClass:"ilrvjyvi"},[a("x-blocks",{staticClass:"children",attrs:{"ai-script":e.aiScript},model:{value:e.value.children,callback:function(t){e.$set(e.value,"children",t)},expression:"value.children"}})],1)])}),[],!1,null,"7b88a5ee",null).exports,v=n.a.extend({i18n:Object(l.a)("pages"),components:{XContainer:u.a},props:{value:{required:!0}},data:()=>({faAlignLeft:s.a}),created(){null==this.value.text&&n.a.set(this.value,"text","")}}),f=(a(714),Object(p.a)(v,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("x-container",{attrs:{draggable:!0},on:{remove:function(){return e.$emit("remove")}},scopedSlots:e._u([{key:"header",fn:function(){return[a("fa",{attrs:{icon:e.faAlignLeft}}),e._v(" "+e._s(e.$t("blocks.text")))]},proxy:!0}])},[a("section",{staticClass:"ihymsbbe"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.value.text,expression:"value.text"}],domProps:{value:e.value.text},on:{input:function(t){t.target.composing||e.$set(e.value,"text",t.target.value)}}})])])}),[],!1,null,"34b9a026",null).exports),m=n.a.extend({i18n:Object(l.a)("pages"),components:{XContainer:u.a},props:{value:{required:!0}},data:()=>({faAlignLeft:s.a}),created(){null==this.value.text&&n.a.set(this.value,"text","")}}),h=(a(716),Object(p.a)(m,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("x-container",{attrs:{draggable:!0},on:{remove:function(){return e.$emit("remove")}},scopedSlots:e._u([{key:"header",fn:function(){return[a("fa",{attrs:{icon:e.faAlignLeft}}),e._v(" "+e._s(e.$t("blocks.textarea")))]},proxy:!0}])},[a("section",{staticClass:"ihymsbbe"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.value.text,expression:"value.text"}],domProps:{value:e.value.text},on:{input:function(t){t.target.composing||e.$set(e.value,"text",t.target.value)}}})])])}),[],!1,null,"22fd9e8d",null).exports),g=a(514),b=n.a.extend({i18n:Object(l.a)("pages"),components:{XContainer:u.a,XFileThumbnail:g.a},props:{value:{required:!0}},data:()=>({file:null,faPencilAlt:s.gc,faImage:r.r,faFolderOpen:r.o}),created(){void 0===this.value.fileId&&n.a.set(this.value,"fileId",null)},mounted(){null==this.value.fileId?this.choose():this.$root.api("drive/files/show",{fileId:this.value.fileId}).then(e=>{this.file=e})},methods:{async choose(){this.$chooseDriveFile({multiple:!1}).then(e=>{this.file=e,this.value.fileId=e.id})}}}),y=(a(718),Object(p.a)(b,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("x-container",{attrs:{draggable:!0},on:{remove:function(){return e.$emit("remove")}},scopedSlots:e._u([{key:"header",fn:function(){return[a("fa",{attrs:{icon:e.faImage}}),e._v(" "+e._s(e.$t("blocks.image")))]},proxy:!0},{key:"func",fn:function(){return[a("button",{on:{click:function(t){return e.choose()}}},[a("fa",{attrs:{icon:e.faFolderOpen}})],1)]},proxy:!0}])},[a("section",{staticClass:"oyyftmcf"},[e.file?a("x-file-thumbnail",{staticClass:"preview",attrs:{file:e.file,detail:!0,fit:"contain"},on:{click:function(t){return e.choose()}}}):e._e()],1)])}),[],!1,null,"028dbefa",null).exports),x=n.a.extend({i18n:Object(l.a)("pages"),components:{XContainer:u.a},props:{value:{required:!0},aiScript:{required:!0}},data:()=>({faBolt:s.s}),created(){null==this.value.text&&n.a.set(this.value,"text",""),null==this.value.action&&n.a.set(this.value,"action","dialog"),null==this.value.content&&n.a.set(this.value,"content",null),null==this.value.event&&n.a.set(this.value,"event",null),null==this.value.message&&n.a.set(this.value,"message",null),null==this.value.primary&&n.a.set(this.value,"primary",!1),null==this.value.var&&n.a.set(this.value,"var",null)}}),_=(a(720),Object(p.a)(x,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("x-container",{attrs:{draggable:!0},on:{remove:function(){return e.$emit("remove")}},scopedSlots:e._u([{key:"header",fn:function(){return[a("fa",{attrs:{icon:e.faBolt}}),e._v(" "+e._s(e.$t("blocks.button")))]},proxy:!0}])},[a("section",{staticClass:"xfhsjczc"},[a("ui-input",{model:{value:e.value.text,callback:function(t){e.$set(e.value,"text",t)},expression:"value.text"}},[a("span",[e._v(e._s(e.$t("blocks._button.text")))])]),a("ui-switch",{model:{value:e.value.primary,callback:function(t){e.$set(e.value,"primary",t)},expression:"value.primary"}},[a("span",[e._v(e._s(e.$t("blocks._button.colored")))])]),a("ui-select",{scopedSlots:e._u([{key:"label",fn:function(){return[e._v(e._s(e.$t("blocks._button.action")))]},proxy:!0}]),model:{value:e.value.action,callback:function(t){e.$set(e.value,"action",t)},expression:"value.action"}},[a("option",{attrs:{value:"dialog"}},[e._v(e._s(e.$t("blocks._button._action.dialog")))]),a("option",{attrs:{value:"resetRandom"}},[e._v(e._s(e.$t("blocks._button._action.resetRandom")))]),a("option",{attrs:{value:"pushEvent"}},[e._v(e._s(e.$t("blocks._button._action.pushEvent")))])]),"dialog"===e.value.action?[a("ui-input",{model:{value:e.value.content,callback:function(t){e.$set(e.value,"content",t)},expression:"value.content"}},[a("span",[e._v(e._s(e.$t("blocks._button._action._dialog.content")))])])]:"pushEvent"===e.value.action?[a("ui-input",{model:{value:e.value.event,callback:function(t){e.$set(e.value,"event",t)},expression:"value.event"}},[a("span",[e._v(e._s(e.$t("blocks._button._action._pushEvent.event")))])]),a("ui-input",{model:{value:e.value.message,callback:function(t){e.$set(e.value,"message",t)},expression:"value.message"}},[a("span",[e._v(e._s(e.$t("blocks._button._action._pushEvent.message")))])]),a("ui-select",{scopedSlots:e._u([{key:"label",fn:function(){return[e._v(e._s(e.$t("blocks._button._action._pushEvent.variable")))]},proxy:!0}]),model:{value:e.value.var,callback:function(t){e.$set(e.value,"var",t)},expression:"value.var"}},[a("option",{domProps:{value:null}},[e._v(e._s(e.$t("blocks._button._action._pushEvent.no-variable")))]),e._l(e.aiScript.getVarsByType(),(function(t){return a("option",{domProps:{value:t.name}},[e._v(e._s(t.name))])})),a("optgroup",{attrs:{label:e.$t("script.pageVariables")}},e._l(e.aiScript.getPageVarsByType(),(function(t){return a("option",{domProps:{value:t}},[e._v(e._s(t))])})),0),a("optgroup",{attrs:{label:e.$t("script.enviromentVariables")}},e._l(e.aiScript.getEnvVarsByType(),(function(t){return a("option",{domProps:{value:t}},[e._v(e._s(t))])})),0)],2)]:e._e()],2)])}),[],!1,null,"bdc6ed76",null).exports),k=n.a.extend({i18n:Object(l.a)("pages"),components:{XContainer:u.a},props:{value:{required:!0}},data:()=>({faBolt:s.s,faMagic:s.Rb}),created(){null==this.value.name&&n.a.set(this.value,"name","")}}),$=Object(p.a)(k,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("x-container",{attrs:{draggable:!0},on:{remove:function(){return e.$emit("remove")}},scopedSlots:e._u([{key:"header",fn:function(){return[a("fa",{attrs:{icon:e.faBolt}}),e._v(" "+e._s(e.$t("blocks.textInput")))]},proxy:!0}])},[a("section",{staticStyle:{padding:"0 16px 0 16px"}},[a("ui-input",{scopedSlots:e._u([{key:"prefix",fn:function(){return[a("fa",{attrs:{icon:e.faMagic}})]},proxy:!0}]),model:{value:e.value.name,callback:function(t){e.$set(e.value,"name",t)},expression:"value.name"}},[a("span",[e._v(e._s(e.$t("blocks._textInput.name")))])]),a("ui-input",{model:{value:e.value.text,callback:function(t){e.$set(e.value,"text",t)},expression:"value.text"}},[a("span",[e._v(e._s(e.$t("blocks._textInput.text")))])]),a("ui-input",{attrs:{type:"text"},model:{value:e.value.default,callback:function(t){e.$set(e.value,"default",t)},expression:"value.default"}},[a("span",[e._v(e._s(e.$t("blocks._textInput.default")))])])],1)])}),[],!1,null,null,null).exports,w=n.a.extend({i18n:Object(l.a)("pages"),components:{XContainer:u.a},props:{value:{required:!0}},data:()=>({faBolt:s.s,faMagic:s.Rb}),created(){null==this.value.name&&n.a.set(this.value,"name","")}}),C=Object(p.a)(w,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("x-container",{attrs:{draggable:!0},on:{remove:function(){return e.$emit("remove")}},scopedSlots:e._u([{key:"header",fn:function(){return[a("fa",{attrs:{icon:e.faBolt}}),e._v(" "+e._s(e.$t("blocks.textareaInput")))]},proxy:!0}])},[a("section",{staticStyle:{padding:"0 16px 16px 16px"}},[a("ui-input",{scopedSlots:e._u([{key:"prefix",fn:function(){return[a("fa",{attrs:{icon:e.faMagic}})]},proxy:!0}]),model:{value:e.value.name,callback:function(t){e.$set(e.value,"name",t)},expression:"value.name"}},[a("span",[e._v(e._s(e.$t("blocks._textareaInput.name")))])]),a("ui-input",{model:{value:e.value.text,callback:function(t){e.$set(e.value,"text",t)},expression:"value.text"}},[a("span",[e._v(e._s(e.$t("blocks._textareaInput.text")))])]),a("ui-textarea",{model:{value:e.value.default,callback:function(t){e.$set(e.value,"default",t)},expression:"value.default"}},[a("span",[e._v(e._s(e.$t("blocks._textareaInput.default")))])])],1)])}),[],!1,null,null,null).exports,S=n.a.extend({i18n:Object(l.a)("pages"),components:{XContainer:u.a},props:{value:{required:!0}},data:()=>({faBolt:s.s,faMagic:s.Rb}),created(){null==this.value.name&&n.a.set(this.value,"name","")}}),j=Object(p.a)(S,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("x-container",{attrs:{draggable:!0},on:{remove:function(){return e.$emit("remove")}},scopedSlots:e._u([{key:"header",fn:function(){return[a("fa",{attrs:{icon:e.faBolt}}),e._v(" "+e._s(e.$t("blocks.numberInput")))]},proxy:!0}])},[a("section",{staticStyle:{padding:"0 16px 0 16px"}},[a("ui-input",{scopedSlots:e._u([{key:"prefix",fn:function(){return[a("fa",{attrs:{icon:e.faMagic}})]},proxy:!0}]),model:{value:e.value.name,callback:function(t){e.$set(e.value,"name",t)},expression:"value.name"}},[a("span",[e._v(e._s(e.$t("blocks._numberInput.name")))])]),a("ui-input",{model:{value:e.value.text,callback:function(t){e.$set(e.value,"text",t)},expression:"value.text"}},[a("span",[e._v(e._s(e.$t("blocks._numberInput.text")))])]),a("ui-input",{attrs:{type:"number"},model:{value:e.value.default,callback:function(t){e.$set(e.value,"default",t)},expression:"value.default"}},[a("span",[e._v(e._s(e.$t("blocks._numberInput.default")))])])],1)])}),[],!1,null,null,null).exports,I=n.a.extend({i18n:Object(l.a)("pages"),components:{XContainer:u.a},props:{value:{required:!0}},data:()=>({faBolt:s.s,faMagic:s.Rb}),created(){null==this.value.name&&n.a.set(this.value,"name","")}}),B=(a(722),Object(p.a)(I,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("x-container",{attrs:{draggable:!0},on:{remove:function(){return e.$emit("remove")}},scopedSlots:e._u([{key:"header",fn:function(){return[a("fa",{attrs:{icon:e.faBolt}}),e._v(" "+e._s(e.$t("blocks.switch")))]},proxy:!0}])},[a("section",{staticClass:"kjuadyyj"},[a("ui-input",{scopedSlots:e._u([{key:"prefix",fn:function(){return[a("fa",{attrs:{icon:e.faMagic}})]},proxy:!0}]),model:{value:e.value.name,callback:function(t){e.$set(e.value,"name",t)},expression:"value.name"}},[a("span",[e._v(e._s(e.$t("blocks._switch.name")))])]),a("ui-input",{model:{value:e.value.text,callback:function(t){e.$set(e.value,"text",t)},expression:"value.text"}},[a("span",[e._v(e._s(e.$t("blocks._switch.text")))])]),a("ui-switch",{model:{value:e.value.default,callback:function(t){e.$set(e.value,"default",t)},expression:"value.default"}},[a("span",[e._v(e._s(e.$t("blocks._switch.default")))])])],1)])}),[],!1,null,"65af1c48",null).exports),T=n.a.extend({i18n:Object(l.a)("pages"),components:{XContainer:u.a},inject:["getPageBlockList"],props:{value:{required:!0},aiScript:{required:!0}},data:()=>({faPlus:s.ic,faQuestion:s.mc}),beforeCreate(){this.$options.components.XBlocks=a(604).default},created(){null==this.value.children&&n.a.set(this.value,"children",[]),void 0===this.value.var&&n.a.set(this.value,"var",null)},methods:{async add(){const{canceled:e,result:t}=await this.$root.dialog({type:null,title:this.$t("choose-block"),select:{groupedItems:this.getPageBlockList()},showCancelButton:!0});if(e)return;const a=Object(o.v4)();this.value.children.push({id:a,type:t})}}}),O=(a(724),Object(p.a)(T,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("x-container",{attrs:{draggable:!0},on:{remove:function(){return e.$emit("remove")}},scopedSlots:e._u([{key:"header",fn:function(){return[a("fa",{attrs:{icon:e.faQuestion}}),e._v(" "+e._s(e.$t("blocks.if")))]},proxy:!0},{key:"func",fn:function(){return[a("button",{on:{click:function(t){return e.add()}}},[a("fa",{attrs:{icon:e.faPlus}})],1)]},proxy:!0}])},[a("section",{staticClass:"romcojzs"},[a("ui-select",{scopedSlots:e._u([{key:"label",fn:function(){return[e._v(e._s(e.$t("blocks._if.variable")))]},proxy:!0}]),model:{value:e.value.var,callback:function(t){e.$set(e.value,"var",t)},expression:"value.var"}},[e._l(e.aiScript.getVarsByType("boolean"),(function(t){return a("option",{domProps:{value:t.name}},[e._v(e._s(t.name))])})),a("optgroup",{attrs:{label:e.$t("script.pageVariables")}},e._l(e.aiScript.getPageVarsByType("boolean"),(function(t){return a("option",{domProps:{value:t}},[e._v(e._s(t))])})),0),a("optgroup",{attrs:{label:e.$t("script.enviromentVariables")}},e._l(e.aiScript.getEnvVarsByType("boolean"),(function(t){return a("option",{domProps:{value:t}},[e._v(e._s(t))])})),0)],2),a("x-blocks",{staticClass:"children",attrs:{"ai-script":e.aiScript},model:{value:e.value.children,callback:function(t){e.$set(e.value,"children",t)},expression:"value.children"}})],1)])}),[],!1,null,"7cdac738",null).exports),P=n.a.extend({i18n:Object(l.a)("pages"),components:{XContainer:u.a},props:{value:{required:!0}},data:()=>({faPaperPlane:r.w}),created(){null==this.value.text&&n.a.set(this.value,"text","")}}),E=Object(p.a)(P,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("x-container",{attrs:{draggable:!0},on:{remove:function(){return e.$emit("remove")}},scopedSlots:e._u([{key:"header",fn:function(){return[a("fa",{attrs:{icon:e.faPaperPlane}}),e._v(" "+e._s(e.$t("blocks.post")))]},proxy:!0}])},[a("section",{staticStyle:{padding:"0 16px 16px 16px"}},[a("ui-textarea",{model:{value:e.value.text,callback:function(t){e.$set(e.value,"text",t)},expression:"value.text"}},[e._v(e._s(e.$t("blocks._post.text")))])],1)])}),[],!1,null,null,null).exports,L=n.a.extend({i18n:Object(l.a)("pages"),components:{XContainer:u.a},props:{value:{required:!0}},data:()=>({faBolt:s.s,faMagic:s.Rb}),created(){null==this.value.name&&n.a.set(this.value,"name","")}}),N=Object(p.a)(L,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("x-container",{attrs:{draggable:!0},on:{remove:function(){return e.$emit("remove")}},scopedSlots:e._u([{key:"header",fn:function(){return[a("fa",{attrs:{icon:e.faBolt}}),e._v(" "+e._s(e.$t("blocks.counter")))]},proxy:!0}])},[a("section",{staticStyle:{padding:"0 16px 0 16px"}},[a("ui-input",{scopedSlots:e._u([{key:"prefix",fn:function(){return[a("fa",{attrs:{icon:e.faMagic}})]},proxy:!0}]),model:{value:e.value.name,callback:function(t){e.$set(e.value,"name",t)},expression:"value.name"}},[a("span",[e._v(e._s(e.$t("blocks._counter.name")))])]),a("ui-input",{model:{value:e.value.text,callback:function(t){e.$set(e.value,"text",t)},expression:"value.text"}},[a("span",[e._v(e._s(e.$t("blocks._counter.text")))])]),a("ui-input",{attrs:{type:"number"},model:{value:e.value.inc,callback:function(t){e.$set(e.value,"inc",t)},expression:"value.inc"}},[a("span",[e._v(e._s(e.$t("blocks._counter.inc")))])])],1)])}),[],!1,null,null,null).exports,q=n.a.extend({i18n:Object(l.a)("pages"),components:{XContainer:u.a},props:{value:{required:!0}},data:()=>({values:"",faBolt:s.s,faMagic:s.Rb}),watch:{values(){n.a.set(this.value,"values",this.values.split("\n"))}},created(){null==this.value.name&&n.a.set(this.value,"name",""),null==this.value.title&&n.a.set(this.value,"title",""),null==this.value.values&&n.a.set(this.value,"values",[]),this.values=this.value.values.join("\n")}}),V=Object(p.a)(q,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("x-container",{attrs:{draggable:!0},on:{remove:function(){return e.$emit("remove")}},scopedSlots:e._u([{key:"header",fn:function(){return[a("fa",{attrs:{icon:e.faBolt}}),e._v(" "+e._s(e.$t("blocks.radioButton")))]},proxy:!0}])},[a("section",{staticStyle:{padding:"0 16px 16px 16px"}},[a("ui-input",{scopedSlots:e._u([{key:"prefix",fn:function(){return[a("fa",{attrs:{icon:e.faMagic}})]},proxy:!0}]),model:{value:e.value.name,callback:function(t){e.$set(e.value,"name",t)},expression:"value.name"}},[a("span",[e._v(e._s(e.$t("blocks._radioButton.name")))])]),a("ui-input",{model:{value:e.value.title,callback:function(t){e.$set(e.value,"title",t)},expression:"value.title"}},[a("span",[e._v(e._s(e.$t("blocks._radioButton.title")))])]),a("ui-textarea",{model:{value:e.values,callback:function(t){e.values=t},expression:"values"}},[a("span",[e._v(e._s(e.$t("blocks._radioButton.values")))])]),a("ui-input",{model:{value:e.value.default,callback:function(t){e.$set(e.value,"default",t)},expression:"value.default"}},[a("span",[e._v(e._s(e.$t("blocks._radioButton.default")))])])],1)])}),[],!1,null,null,null).exports,z=n.a.extend({components:{XDraggable:i,XSection:d,XText:f,XImage:y,XButton:_,XTextarea:h,XTextInput:$,XTextareaInput:C,XNumberInput:j,XSwitch:B,XIf:O,XPost:E,XCounter:N,XRadioButton:V},props:{value:{type:Array,required:!0},aiScript:{required:!0}},computed:{blocks(){return this.value}},methods:{updateItem(e){const t=this.blocks.findIndex(t=>t.id===e.id),a=[...this.blocks.slice(0,t),e,...this.blocks.slice(t+1)];this.$emit("input",a)},removeItem(e){const t=this.blocks.findIndex(t=>t.id===e.id),a=[...this.blocks.slice(0,t),...this.blocks.slice(t+1)];this.$emit("input",a)}}}),A=Object(p.a)(z,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("x-draggable",{attrs:{tag:"div",list:e.blocks,handle:".drag-handle",group:{name:"blocks"},animation:"150","swap-threshold":"0.5"}},e._l(e.blocks,(function(t){return a("x-"+t.type,{key:t.id,tag:"component",attrs:{value:t,"ai-script":e.aiScript},on:{input:e.updateItem,remove:function(){return e.removeItem(t)}}})})),1)}),[],!1,null,null,null);t.default=A.exports},614:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a(2),o=a(502),s=a(5),r=a(511),l=a(14),u=n.a.extend({i18n:Object(i.a)("pages"),components:{XContainer:o.a},inject:["getScriptBlockList"],props:{getExpectedType:{required:!1,default:null},value:{required:!0},title:{required:!1},removable:{required:!1,default:!1},aiScript:{required:!0},name:{required:!0},fnSlots:{required:!1},draggable:{required:!1,default:!1}},data:()=>({error:null,warn:null,slots:"",faPencilAlt:s.gc}),computed:{icon(){return null===this.value.type?null:this.value.type.startsWith("fn:")?s.hc:r.a.find(e=>e.type===this.value.type).icon},typeText(){return null===this.value.type?null:this.value.type.startsWith("fn:")?this.value.type.split(":")[1]:this.$t(`script.blocks.${this.value.type}`)}},watch:{slots(){this.value.value.slots=this.slots.split("\n").map(e=>({name:e,type:null}))}},beforeCreate(){this.$options.components.XV=a(614).default},created(){null==this.value.value&&n.a.set(this.value,"value",null),this.value.value&&this.value.value.slots&&(this.slots=this.value.value.slots.map(e=>e.name).join("\n")),this.$watch("value.type",e=>{if(this.warn=null,"fn"===this.value.type){const e=Object(l.v4)();return this.value.value={},n.a.set(this.value.value,"slots",[]),void n.a.set(this.value.value,"expression",{id:e,type:null})}if(this.value.type&&this.value.type.startsWith("fn:")){const e=this.value.type.split(":")[1],t=this.aiScript.getVarByName(e),a=[];for(let e=0;e<t.value.slots.length;e++){const e=Object(l.v4)();a.push({id:e,type:null})}return void n.a.set(this.value,"args",a)}if(Object(r.e)(this.value))return;const t=[];for(let e=0;e<r.c[this.value.type].in.length;e++){const e=Object(l.v4)();t.push({id:e,type:null})}n.a.set(this.value,"args",t);for(let e=0;e<r.c[this.value.type].in.length;e++){const t=r.c[this.value.type].in[e];"number"!=typeof t&&("number"===t&&(this.value.args[e].type="number"),"string"===t&&(this.value.args[e].type="text"))}}),this.$watch("value.args",e=>{if(null==e)return void(this.warn=null);const t=e.findIndex(e=>null===e.type);-1!==t&&t<e.length?this.warn={slot:t}:this.warn=null},{deep:!0}),this.$watch("aiScript.variables",()=>{null!=this.type&&this.value&&(this.error=this.aiScript.typeCheck(this.value))},{deep:!0})},methods:{async changeType(){const{canceled:e,result:t}=await this.$root.dialog({type:null,title:this.$t("select-type"),select:{groupedItems:this.getScriptBlockList(this.getExpectedType?this.getExpectedType():null)},showCancelButton:!0});e||(this.value.type=t)},_getExpectedType(e){return this.aiScript.getExpectedType(this.value,e)}}}),c=(a(710),a(1)),p=Object(c.a)(u,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("x-container",{attrs:{removable:e.removable,error:e.error,warn:e.warn,draggable:e.draggable},on:{remove:function(){return e.$emit("remove")}},scopedSlots:e._u([{key:"header",fn:function(){return[e.icon?a("fa",{attrs:{icon:e.icon}}):e._e(),e.title?[e._v(e._s(e.title)+" "),e.typeText?a("span",{staticClass:"turmquns"},[e._v("("+e._s(e.typeText)+")")]):e._e()]:e.typeText?[e._v(e._s(e.typeText))]:e._e()]},proxy:!0},{key:"func",fn:function(){return[a("button",{on:{click:function(t){return e.changeType()}}},[a("fa",{attrs:{icon:e.faPencilAlt}})],1)]},proxy:!0}])},[null===e.value.type?a("section",{staticClass:"pbglfege",on:{click:function(t){return e.changeType()}}},[e._v("\n\t\t"+e._s(e.$t("script.emptySlot"))+"\n\t")]):"text"===e.value.type?a("section",{staticClass:"tbwccoaw"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.value.value,expression:"value.value"}],domProps:{value:e.value.value},on:{input:function(t){t.target.composing||e.$set(e.value,"value",t.target.value)}}})]):"multiLineText"===e.value.type?a("section",{staticClass:"tbwccoaw"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.value.value,expression:"value.value"}],domProps:{value:e.value.value},on:{input:function(t){t.target.composing||e.$set(e.value,"value",t.target.value)}}})]):"textList"===e.value.type?a("section",{staticClass:"tbwccoaw"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.value.value,expression:"value.value"}],attrs:{placeholder:e.$t("script.blocks._textList.info")},domProps:{value:e.value.value},on:{input:function(t){t.target.composing||e.$set(e.value,"value",t.target.value)}}})]):"number"===e.value.type?a("section",{staticClass:"tbwccoaw"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.value.value,expression:"value.value"}],attrs:{type:"number"},domProps:{value:e.value.value},on:{input:function(t){t.target.composing||e.$set(e.value,"value",t.target.value)}}})]):"ref"===e.value.type?a("section",{staticClass:"hpdwcrvs"},[a("select",{directives:[{name:"model",rawName:"v-model",value:e.value.value,expression:"value.value"}],on:{change:function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.value,"value",t.target.multiple?a:a[0])}}},[e._l(e.aiScript.getVarsByType(e.getExpectedType?e.getExpectedType():null).filter((function(t){return t.name!==e.name})),(function(t){return a("option",{domProps:{value:t.name}},[e._v(e._s(t.name))])})),a("optgroup",{attrs:{label:e.$t("script.argVariables")}},e._l(e.fnSlots,(function(t){return a("option",{domProps:{value:t.name}},[e._v(e._s(t.name))])})),0),a("optgroup",{attrs:{label:e.$t("script.pageVariables")}},e._l(e.aiScript.getPageVarsByType(e.getExpectedType?e.getExpectedType():null),(function(t){return a("option",{domProps:{value:t}},[e._v(e._s(t))])})),0),a("optgroup",{attrs:{label:e.$t("script.enviromentVariables")}},e._l(e.aiScript.getEnvVarsByType(e.getExpectedType?e.getExpectedType():null),(function(t){return a("option",{domProps:{value:t}},[e._v(e._s(t))])})),0)],2)]):"fn"===e.value.type?a("section",{staticStyle:{padding:"0 16px 16px 16px"}},[a("ui-textarea",{scopedSlots:e._u([{key:"desc",fn:function(){return[e._v(e._s(e.$t("script.blocks._fn.slots-info")))]},proxy:!0}]),model:{value:e.slots,callback:function(t){e.slots=t},expression:"slots"}},[a("span",[e._v(e._s(e.$t("script.blocks._fn.slots")))])]),e.value.value.expression?a("x-v",{attrs:{title:e.$t("script.blocks._fn.arg1"),"get-expected-type":function(){return null},"ai-script":e.aiScript,"fn-slots":e.value.value.slots,name:e.name},model:{value:e.value.value.expression,callback:function(t){e.$set(e.value.value,"expression",t)},expression:"value.value.expression"}}):e._e()],1):e.value.type.startsWith("fn:")?a("section",{staticStyle:{padding:"16px"}},e._l(e.value.args,(function(t,n){return a("x-v",{key:n,attrs:{title:e.aiScript.getVarByName(e.value.type.split(":")[1]).value.slots[n].name,"get-expected-type":function(){return null},"ai-script":e.aiScript,name:e.name},model:{value:e.value.args[n],callback:function(t){e.$set(e.value.args,n,t)},expression:"value.args[i]"}})})),1):a("section",{staticStyle:{padding:"16px"}},e._l(e.value.args,(function(t,n){return a("x-v",{key:n,attrs:{title:e.$t("script.blocks._"+e.value.type+".arg"+(n+1)),"get-expected-type":function(){return e._getExpectedType(n)},"ai-script":e.aiScript,name:e.name,"fn-slots":e.fnSlots},model:{value:e.value.args[n],callback:function(t){e.$set(e.value.args,n,t)},expression:"value.args[i]"}})})),1)])}),[],!1,null,"51cafd99",null);t.default=p.exports},708:function(e,t,a){"use strict";var n=a(559);a.n(n).a},709:function(e,t,a){(t=a(3)(!1)).push([e.i,".cpjygsrt[data-v-60ccf125]{overflow:hidden;background:var(--face);border:2px solid var(--pageBlockBorder);border-radius:6px}.cpjygsrt[data-v-60ccf125]:hover{border:2px solid var(--pageBlockBorderHover)}.cpjygsrt.warn[data-v-60ccf125]{border:2px solid #dec44c}.cpjygsrt.error[data-v-60ccf125]{border:2px solid red}.cpjygsrt+.cpjygsrt[data-v-60ccf125]{margin-top:16px}.cpjygsrt>header>.title[data-v-60ccf125]{z-index:1;margin:0;padding:0 16px;line-height:42px;font-size:.9em;font-weight:700;color:var(--faceHeaderText);box-shadow:0 1px rgba(0,0,0,.07)}.cpjygsrt>header>.title>[data-icon][data-v-60ccf125]{margin-right:6px}.cpjygsrt>header>.title[data-v-60ccf125]:empty{display:none}.cpjygsrt>header>.buttons[data-v-60ccf125]{position:absolute;z-index:2;top:0;right:0}.cpjygsrt>header>.buttons>button[data-v-60ccf125]{padding:0;width:42px;font-size:.9em;line-height:42px;color:var(--faceTextButton)}.cpjygsrt>header>.buttons>button[data-v-60ccf125]:hover{color:var(--faceTextButtonHover)}.cpjygsrt>header>.buttons>button[data-v-60ccf125]:active{color:var(--faceTextButtonActive)}.cpjygsrt>header>.buttons .drag-handle[data-v-60ccf125]{cursor:move}.cpjygsrt>.warn[data-v-60ccf125]{color:#b19e49}.cpjygsrt>.error[data-v-60ccf125],.cpjygsrt>.warn[data-v-60ccf125]{margin:0;padding:16px 16px 0;font-size:14px}.cpjygsrt>.error[data-v-60ccf125]{color:red}",""]),e.exports=t},710:function(e,t,a){"use strict";var n=a(560);a.n(n).a},711:function(e,t,a){(t=a(3)(!1)).push([e.i,".turmquns[data-v-51cafd99]{opacity:.7}.pbglfege[data-v-51cafd99]{opacity:.5;padding:16px;text-align:center;cursor:pointer;color:var(--text)}.tbwccoaw>input[data-v-51cafd99],.tbwccoaw>textarea[data-v-51cafd99]{display:block;-webkit-appearance:none;-moz-appearance:none;appearance:none;width:100%;max-width:100%;min-width:100%;border:none;box-shadow:none;padding:16px;font-size:16px;background:transparent;color:var(--text)}.tbwccoaw>textarea[data-v-51cafd99]{min-height:100px}.hpdwcrvs[data-v-51cafd99]{padding:16px}.hpdwcrvs>select[data-v-51cafd99]{display:block;padding:4px;font-size:16px;width:100%}",""]),e.exports=t},712:function(e,t,a){"use strict";var n=a(561);a.n(n).a},713:function(e,t,a){(t=a(3)(!1)).push([e.i,".ilrvjyvi>.children[data-v-7b88a5ee]{padding:16px}",""]),e.exports=t},714:function(e,t,a){"use strict";var n=a(562);a.n(n).a},715:function(e,t,a){(t=a(3)(!1)).push([e.i,".ihymsbbe>textarea[data-v-34b9a026]{display:block;-webkit-appearance:none;-moz-appearance:none;appearance:none;width:100%;min-width:100%;min-height:150px;border:none;box-shadow:none;padding:16px;background:transparent;color:var(--text);font-size:14px}",""]),e.exports=t},716:function(e,t,a){"use strict";var n=a(563);a.n(n).a},717:function(e,t,a){(t=a(3)(!1)).push([e.i,".ihymsbbe>textarea[data-v-22fd9e8d]{display:block;-webkit-appearance:none;-moz-appearance:none;appearance:none;width:100%;min-width:100%;min-height:150px;border:none;box-shadow:none;padding:16px;background:transparent;color:var(--text);font-size:14px}",""]),e.exports=t},718:function(e,t,a){"use strict";var n=a(564);a.n(n).a},719:function(e,t,a){(t=a(3)(!1)).push([e.i,".oyyftmcf>.preview[data-v-028dbefa]{height:150px}",""]),e.exports=t},720:function(e,t,a){"use strict";var n=a(565);a.n(n).a},721:function(e,t,a){(t=a(3)(!1)).push([e.i,".xfhsjczc[data-v-bdc6ed76]{padding:0 16px}",""]),e.exports=t},722:function(e,t,a){"use strict";var n=a(566);a.n(n).a},723:function(e,t,a){(t=a(3)(!1)).push([e.i,".kjuadyyj[data-v-65af1c48]{padding:0 16px 16px}",""]),e.exports=t},724:function(e,t,a){"use strict";var n=a(567);a.n(n).a},725:function(e,t,a){(t=a(3)(!1)).push([e.i,".romcojzs[data-v-7cdac738]{padding:0 16px 16px}",""]),e.exports=t},726:function(e,t,a){"use strict";var n=a(568);a.n(n).a},727:function(e,t,a){(t=a(3)(!1)).push([e.i,".gwbmwxkm[data-v-935f6254]{overflow:hidden;background:var(--face);margin-bottom:16px}.gwbmwxkm.round[data-v-935f6254]{border-radius:6px}.gwbmwxkm.shadow[data-v-935f6254]{box-shadow:0 3px 8px rgba(0,0,0,.2)}.gwbmwxkm>header[data-v-935f6254]{background:var(--faceHeader)}.gwbmwxkm>header>.title[data-v-935f6254]{z-index:1;margin:0;padding:0 16px;line-height:42px;font-size:.9em;font-weight:700;color:var(--faceHeaderText);box-shadow:0 var(--lineWidth) rgba(0,0,0,.07)}.gwbmwxkm>header>.title>[data-icon][data-v-935f6254]{margin-right:6px}.gwbmwxkm>header>.title[data-v-935f6254]:empty{display:none}.gwbmwxkm>header>.buttons[data-v-935f6254]{position:absolute;z-index:2;top:0;right:0}.gwbmwxkm>header>.buttons>button[data-v-935f6254]{padding:0;width:42px;font-size:.9em;line-height:42px;color:var(--faceTextButton)}.gwbmwxkm>header>.buttons>button[data-v-935f6254]:hover{color:var(--faceTextButtonHover)}.gwbmwxkm>header>.buttons>button[data-v-935f6254]:active{color:var(--faceTextButtonActive)}.gwbmwxkm>section[data-v-935f6254]{padding:0 32px 32px}@media (max-width:500px){.gwbmwxkm>section[data-v-935f6254]{padding:0 16px 16px}}.gwbmwxkm>section>.view[data-v-935f6254]{display:inline-block;margin:16px 0 0;font-size:14px}.gwbmwxkm>section>.content[data-v-935f6254],.gwbmwxkm>section>.eyeCatch[data-v-935f6254]{margin-bottom:16px}.gwbmwxkm>section>.eyeCatch>div>img[data-v-935f6254]{max-width:100%}.qmuvgica[data-v-935f6254]{padding:32px}@media (max-width:500px){.qmuvgica[data-v-935f6254]{padding:16px}}.qmuvgica>.add[data-v-935f6254],.qmuvgica>.variables[data-v-935f6254]{margin-bottom:16px}",""]),e.exports=t},890:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a(189),o=a(5),s=a(10),r=a(2),l=a(614),u=a(604),c=a(14),p=a(511),d=a(11),v=function(e,t,a,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,a,n);else for(var r=e.length-1;r>=0;r--)(i=e[r])&&(s=(o<3?i(s):o>3?i(t,a,s):i(t,a))||s);return o>3&&s&&Object.defineProperty(t,a,s),s};class f{constructor(e=[],t=[]){this.variables=e,this.pageVars=t}typeCheck(e){if(Object(p.e)(e))return null;const t=p.c[e.type];if(null==t)throw new Error("Unknown type: "+e.type);const a=[];for(let n=0;n<t.in.length;n++){const i=t.in[n],o=this.infer(e.args[n]);if(null!==o)if("number"==typeof i){if(void 0===a[i])a[i]=o;else if(o!==a[i])return{arg:n,expect:a[i],actual:o}}else if(o!==i)return{arg:n,expect:i,actual:o}}return null}getExpectedType(e,t){const a=p.c[e.type];if(null==a)throw new Error("Unknown type: "+e.type);const n=[];for(let t=0;t<a.in.length;t++){const i=a.in[t],o=this.infer(e.args[t]);null!==o&&("number"==typeof i&&void 0===n[i]&&(n[i]=o))}return"number"==typeof a.in[t]?n[a.in[t]]||null:a.in[t]}infer(e){if(null===e.type)return null;if("text"===e.type)return"string";if("multiLineText"===e.type)return"string";if("textList"===e.type)return"stringArray";if("number"===e.type)return"number";if("ref"===e.type){const t=this.variables.find(t=>t.name===e.value);if(t)return this.infer(t);const a=this.pageVars.find(t=>t.name===e.value);if(a)return a.type;const n=p.b[e.value];return void 0!==n?n:null}if("fn"===e.type)return null;if(e.type.startsWith("fn:"))return null;const t=[],a=p.c[e.type];for(let n=0;n<a.in.length;n++){const i=a.in[n];if("number"==typeof i){const a=this.infer(e.args[n]);void 0===t[i]?t[i]=a:a!==t[i]&&(t[i]=null)}}return"number"==typeof a.out?t[a.out]:a.out}getVarByName(e){const t=this.variables.find(t=>t.name===e);if(void 0!==t)return t;throw new Error(`No such variable '${e}'`)}getVarsByType(e){return null==e?this.variables:this.variables.filter(t=>null===this.infer(t)||this.infer(t)===e)}getEnvVarsByType(e){return null==e?Object.keys(p.b):Object.entries(p.b).filter(([t,a])=>null===a||e===a).map(([e,t])=>e)}getPageVarsByType(e){return null==e?this.pageVars.map(e=>e.name):this.pageVars.filter(t=>e===t.type).map(e=>e.name)}isUsedName(e){return!!this.variables.some(t=>t.name===e)||(!!this.pageVars.some(t=>t.name===e)||!!p.b[e])}}v([d.a],f.prototype,"typeCheck",null),v([d.a],f.prototype,"getExpectedType",null),v([d.a],f.prototype,"infer",null),v([d.a],f.prototype,"getVarByName",null),v([d.a],f.prototype,"getVarsByType",null),v([d.a],f.prototype,"getEnvVarsByType",null),v([d.a],f.prototype,"getPageVarsByType",null),v([d.a],f.prototype,"isUsedName",null);var m=a(6),h=a(547),g=n.a.extend({i18n:Object(r.a)("pages"),components:{XDraggable:i,XVariable:l.default,XBlocks:u.default},props:{initPageId:{type:String,required:!1},initPageName:{type:String,required:!1},initUser:{type:String,required:!1}},data(){return{author:this.$store.state.i,readonly:!1,page:null,pageId:null,currentName:null,title:"",summary:null,name:Date.now().toString(),eyeCatchingImage:null,eyeCatchingImageId:null,font:"sans-serif",content:[],alignCenter:!1,hideTitleWhenPinned:!1,variables:[],aiScript:null,showOptions:!1,moreDetails:!1,url:m.url,faPlus:o.ic,faICursor:o.Eb,faSave:s.z,faStickyNote:s.C,faMagic:o.Rb,faCog:o.M,faTrashAlt:s.F,faExternalLinkSquareAlt:o.fb,faCode:o.L}},watch:{async eyeCatchingImageId(){null==this.eyeCatchingImageId?this.eyeCatchingImage=null:this.eyeCatchingImage=await this.$root.api("drive/files/show",{fileId:this.eyeCatchingImageId})}},async created(){if(this.aiScript=new f,this.$watch("variables",()=>{this.aiScript.variables=this.variables},{deep:!0}),this.$watch("content",()=>{this.aiScript.pageVars=Object(h.a)(this.content)},{deep:!0}),this.initPageId?this.page=await this.$root.api("pages/show",{pageId:this.initPageId}):this.initPageName&&this.initUser&&(this.page=await this.$root.api("pages/show",{name:this.initPageName,username:this.initUser}),this.readonly=!0),this.page)this.author=this.page.user,this.pageId=this.page.id,this.title=this.page.title,this.name=this.page.name,this.currentName=this.page.name,this.summary=this.page.summary,this.font=this.page.font,this.hideTitleWhenPinned=this.page.hideTitleWhenPinned,this.alignCenter=this.page.alignCenter,this.content=this.page.content,this.variables=this.page.variables,this.eyeCatchingImageId=this.page.eyeCatchingImageId;else{const e=Object(c.v4)();this.content=[{id:e,type:"text",text:"Hello World!"}]}},provide(){return{readonly:this.readonly,getScriptBlockList:this.getScriptBlockList,getPageBlockList:this.getPageBlockList}},methods:{save(){const e={title:this.title.trim(),name:this.name.trim(),summary:this.summary,font:this.font,hideTitleWhenPinned:this.hideTitleWhenPinned,alignCenter:this.alignCenter,content:this.content,variables:this.variables,eyeCatchingImageId:this.eyeCatchingImageId},t=e=>{"3d81ceae-475f-4600-b2a8-2bc116157532"==e.id?"name"==e.info.param&&this.$root.dialog({type:"error",title:this.$t("title-invalid-name"),text:this.$t("text-invalid-name")}):"NAME_ALREADY_EXISTS"==e.code&&this.$root.dialog({type:"error",text:this.$t("name-already-exists")})};this.pageId?(e.pageId=this.pageId,this.$root.api("pages/update",e).then(e=>{this.currentName=this.name.trim(),this.$root.dialog({type:"success",text:this.$t("page-updated")})}).catch(t)):this.$root.api("pages/create",e).then(e=>{this.pageId=e.id,this.currentName=this.name.trim(),this.$root.dialog({type:"success",text:this.$t("page-created")}),this.$router.push(`/i/pages/edit/${this.pageId}`)}).catch(t)},del(){this.$root.dialog({type:"warning",text:this.$t("are-you-sure-delete"),showCancelButton:!0}).then(({canceled:e})=>{e||this.$root.api("pages/delete",{pageId:this.pageId}).then(()=>{this.$root.dialog({type:"success",text:this.$t("page-deleted")}),this.$router.push("/i/pages")})})},async add(){const{canceled:e,result:t}=await this.$root.dialog({type:null,title:this.$t("choose-block"),select:{groupedItems:this.getPageBlockList()},showCancelButton:!0});if(e)return;const a=Object(c.v4)();this.content.push({id:a,type:t})},async addVariable(){let{canceled:e,result:t}=await this.$root.dialog({title:this.$t("enter-variable-name"),input:{type:"text"},showCancelButton:!0});if(e)return;if(t=t.trim(),this.aiScript.isUsedName(t))return void this.$root.dialog({type:"error",text:this.$t("the-variable-name-is-already-used")});const a=Object(c.v4)();this.variables.push({id:a,name:t,type:null})},removeVariable(e){const t=this.variables.findIndex(t=>t.name===e.name),a=[...this.variables.slice(0,t),...this.variables.slice(t+1)];this.variables=a},getPageBlockList(){return[{label:this.$t("content-blocks"),items:[{value:"section",text:this.$t("blocks.section")},{value:"text",text:this.$t("blocks.text")},{value:"image",text:this.$t("blocks.image")},{value:"textarea",text:this.$t("blocks.textarea")}]},{label:this.$t("input-blocks"),items:[{value:"button",text:this.$t("blocks.button")},{value:"radioButton",text:this.$t("blocks.radioButton")},{value:"textInput",text:this.$t("blocks.textInput")},{value:"textareaInput",text:this.$t("blocks.textareaInput")},{value:"numberInput",text:this.$t("blocks.numberInput")},{value:"switch",text:this.$t("blocks.switch")},{value:"counter",text:this.$t("blocks.counter")}]},{label:this.$t("special-blocks"),items:[{value:"if",text:this.$t("blocks.if")},{value:"post",text:this.$t("blocks.post")}]}]},getScriptBlockList(e=null){const t=[],a=p.a.filter(t=>null===e||null===t.out||t.out===e||"number"==typeof t.out);for(const e of a){const a=t.find(t=>t.category===e.category);a?a.items.push({value:e.type,text:this.$t(`script.blocks.${e.type}`)}):t.push({category:e.category,label:this.$t(`script.categories.${e.category}`),items:[{value:e.type,text:this.$t(`script.blocks.${e.type}`)}]})}const n=this.variables.filter(e=>"fn"===e.type);return n.length>0&&t.unshift({label:this.$t("script.categories.fn"),items:n.map(e=>({value:"fn:"+e.name,text:e.name}))}),t},setEyeCatchingImage(){this.$chooseDriveFile({multiple:!1}).then(e=>{this.eyeCatchingImageId=e.id})},removeEyeCatchingImage(){this.eyeCatchingImageId=null}}}),b=(a(726),a(1)),y=Object(b.a)(g,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"gwbmwxkm",class:{shadow:e.$store.state.device.useShadow,round:e.$store.state.device.roundedCorners}},[a("header",[a("div",{staticClass:"title"},[a("fa",{attrs:{icon:e.faStickyNote}}),e._v(" "+e._s(e.readonly?e.$t("read-page"):e.pageId?e.$t("edit-page"):e.$t("new-page")))],1),a("div",{staticClass:"buttons"},[e.readonly?e._e():a("button",{on:{click:function(t){return e.del()}}},[a("fa",{attrs:{icon:e.faTrashAlt}})],1),a("button",{on:{click:function(){return e.showOptions=!e.showOptions}}},[a("fa",{attrs:{icon:e.faCog}})],1),e.readonly?e._e():a("button",{on:{click:function(t){return e.save()}}},[a("fa",{attrs:{icon:e.faSave}})],1)])]),a("section",[e.pageId?a("router-link",{staticClass:"view",attrs:{to:"/@"+e.author.username+"/pages/"+e.currentName}},[a("fa",{attrs:{icon:e.faExternalLinkSquareAlt}}),e._v(" "+e._s(e.$t("view-page")))],1):e._e(),a("ui-input",{model:{value:e.title,callback:function(t){e.title=t},expression:"title"}},[a("span",[e._v(e._s(e.$t("title")))])]),e.showOptions?[a("ui-input",{model:{value:e.summary,callback:function(t){e.summary=t},expression:"summary"}},[a("span",[e._v(e._s(e.$t("summary")))])]),a("ui-input",{scopedSlots:e._u([{key:"prefix",fn:function(){return[e._v(e._s(e.url)+"/@"+e._s(e.author.username)+"/pages/")]},proxy:!0}],null,!1,4273545007),model:{value:e.name,callback:function(t){e.name=t},expression:"name"}},[a("span",[e._v(e._s(e.$t("url")))])]),a("ui-switch",{model:{value:e.alignCenter,callback:function(t){e.alignCenter=t},expression:"alignCenter"}},[e._v(e._s(e.$t("align-center")))]),a("ui-select",{scopedSlots:e._u([{key:"label",fn:function(){return[e._v(e._s(e.$t("font")))]},proxy:!0}],null,!1,3493738196),model:{value:e.font,callback:function(t){e.font=t},expression:"font"}},[a("option",{attrs:{value:"serif"}},[e._v(e._s(e.$t("fontSerif")))]),a("option",{attrs:{value:"sans-serif"}},[e._v(e._s(e.$t("fontSansSerif")))])]),a("ui-switch",{model:{value:e.hideTitleWhenPinned,callback:function(t){e.hideTitleWhenPinned=t},expression:"hideTitleWhenPinned"}},[e._v(e._s(e.$t("hide-title-when-pinned")))]),a("div",{staticClass:"eyeCatch"},[null!=e.eyeCatchingImageId||e.readonly?e.eyeCatchingImage?a("div",[a("img",{attrs:{src:e.eyeCatchingImage.url,alt:e.eyeCatchingImage.name}}),e.readonly?e._e():a("ui-button",{on:{click:function(t){return e.removeEyeCatchingImage()}}},[a("fa",{attrs:{icon:e.faTrashAlt}}),e._v(" "+e._s(e.$t("remove-eye-catching-image")))],1)],1):e._e():a("ui-button",{on:{click:function(t){return e.setEyeCatchingImage()}}},[a("fa",{attrs:{icon:e.faPlus}}),e._v(" "+e._s(e.$t("set-eye-catching-image")))],1)],1)]:e._e(),a("x-blocks",{staticClass:"content",attrs:{"ai-script":e.aiScript},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}}),e.readonly?e._e():a("ui-button",{on:{click:function(t){return e.add()}}},[a("fa",{attrs:{icon:e.faPlus}})],1)],2)]),a("ui-container",{attrs:{"body-togglable":!0},scopedSlots:e._u([{key:"header",fn:function(){return[a("fa",{attrs:{icon:e.faMagic}}),e._v(" "+e._s(e.$t("variables")))]},proxy:!0}])},[a("div",{staticClass:"qmuvgica"},[a("x-draggable",{directives:[{name:"show",rawName:"v-show",value:e.variables.length>0,expression:"variables.length > 0"}],staticClass:"variables",attrs:{tag:"div",list:e.variables,handle:".drag-handle",group:{name:"variables"},animation:"150","swap-threshold":"0.5"}},e._l(e.variables,(function(t){return a("x-variable",{key:t.name,attrs:{value:t,removable:!0,"ai-script":e.aiScript,name:t.name,title:t.name,draggable:!0},on:{input:function(t){return e.updateVariable(t)},remove:function(){return e.removeVariable(t)}}})})),1),e.readonly?e._e():a("ui-button",{staticClass:"add",on:{click:function(t){return e.addVariable()}}},[a("fa",{attrs:{icon:e.faPlus}})],1),a("ui-info",[a("span",{domProps:{innerHTML:e._s(e.$t("variables-info"))}}),a("a",{staticStyle:{display:"block"},on:{click:function(){return e.moreDetails=!0}}},[e._v(e._s(e.$t("more-details")))])]),e.moreDetails?[a("ui-info",[a("span",{domProps:{innerHTML:e._s(e.$t("variables-info2"))}})]),a("ui-info",[a("span",{domProps:{innerHTML:e._s(e.$t("variables-info3"))}})]),a("ui-info",[a("span",{domProps:{innerHTML:e._s(e.$t("variables-info4"))}})])]:e._e()],2)]),a("ui-container",{attrs:{"body-togglable":!0,expanded:!1},scopedSlots:e._u([{key:"header",fn:function(){return[a("fa",{attrs:{icon:e.faCode}}),e._v(" "+e._s(e.$t("inspector")))]},proxy:!0}])},[a("div",{staticStyle:{padding:"0 32px 32px 32px"}},[a("ui-textarea",{attrs:{value:JSON.stringify(e.content,null,2),readonly:"",tall:""}},[e._v(e._s(e.$t("content")))]),a("ui-textarea",{attrs:{value:JSON.stringify(e.variables,null,2),readonly:"",tall:""}},[e._v(e._s(e.$t("variables")))])],1)])],1)}),[],!1,null,"935f6254",null);t.default=y.exports}}]);
//# sourceMappingURL=0.11.37.1.js.map